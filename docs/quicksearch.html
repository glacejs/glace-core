<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"globals_index.js.html":{"id":"globals_index.js.html","title":"Source: globals/index.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/index.js /* global beforeEach afterEach */ &quot;use strict&quot;; /** * Contains global framework functions and helpers. * * @module */ var chai = require(&quot;chai&quot;); var chai_as_promised = require(&quot;chai-as-promised&quot;); var sinon = require(&quot;sinon&quot;); var sinon_chai = require(&quot;sinon-chai&quot;); chai.use(chai_as_promised); chai.use(sinon_chai); require(&quot;../matcher&quot;); var CONF = require(&quot;../config&quot;); var plugins = require(&quot;../plugins&quot;); var Steps = require(&quot;../steps&quot;); /** * `chaijs` `expect` function. * * @global * @function * @arg {*} actualValue - Some actual value which should be checked. * @see {@link http://chaijs.com/|chaijs} to get more details about * `expect` usage. * @example expect(1).to.be.equal(1); expect(2).to.be.gte(0); */ global.expect = chai.expect; /** * `SinonJS` is pretty nice lib for mocking. * * @global */ global.sinon = sinon; global.rewire = require(&quot;./rewire&quot;); /** * `GlaceJS` config. * * @global * @see {@link module:config|config} to get more details about its options. */ global.CONF = CONF; /** * Atomic steps collection. * * @global * @type {Steps} * @see {@link module:steps/index|steps} to get more details about its methods. */ global.SS = Steps.getInstance(); global.scope = require(&quot;./scope&quot;); global.session = require(&quot;./session&quot;); global.test = require(&quot;./test&quot;); global.chunk = require(&quot;./chunk&quot;); global.forEachLanguage = require(&quot;./forEachLanguage&quot;); /** * Executes before each test chunk. * * @global * @function * @arg {string} name - Name of test case. * @arg {function} func - Hook function. * @example test(&quot;Some test&quot;, () =&gt; { beforeChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); */ global.beforeChunk = beforeEach; /** * Executes after each test chunk. * * @global * @function * @arg {string} name - Name of test case. * @arg {function} func - Hook function. * @example test(&quot;Some test&quot;, () =&gt; { afterChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); */ global.afterChunk = afterEach; /* Load globals from plugins */ plugins.getModules(&quot;globals&quot;); × Search results Close "},"globals_test.js.html":{"id":"globals_test.js.html","title":"Source: globals/test.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/test.js /* global scope session before after */ &quot;use strict&quot;; var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var U = require(&quot;glace-utils&quot;); var LOG = U.logger; var CONF = require(&quot;../config&quot;); var hacking = require(&quot;../hacking&quot;); var TestCase = require(&quot;../testing&quot;).TestCase; /** * Helper to set actual log file. * * @function */ var setLog = () =&gt; { var testName = CONF.curTestCase ? _.kebabCase(CONF.curTestCase.name) : &quot;&quot;; var logFile = path.resolve(CONF.logsDir, testName, &quot;logs&quot;, &quot;test.log&quot;); LOG.setFile(logFile); }; setLog(); // Set log immediatelly. /** * Basis for any test case. * * If test with the same was registered already, this test will be omitted * with corresponding error in log. * * If retries amount is specified and this test was failed, the test will be * added to queue in separated session with title containing `Retry` and its * number. * * @abstract * @function * @arg {string} name - Name of test case. * @arg {object} [opts] - Options. * @arg {boolean} [opts.skip=false] - Flag to skip test. * @arg {string} [opts.skipReason=null] - Skip reason if test is marked as skipped. * @arg {number} [opts.retry=0] - Number of retries on failure. Overrides * config value for concrete test. * @arg {number} [opts.chunkRetry=0] - Number of chunk retries on failure. * Overrides config value for concrete test chunks. * @arg {?number} [opts.chunkTimeout=null] - Time to execute chunk or hook, sec. * @arg {function[]} [fixtures] - Involved fixtures list. * @arg {function} func - Test function. */ var baseTest = (names =&gt; { return (name, opts, fixtures, func) =&gt; { if (names.includes(name)) { throw new Error(`Test case '${name}' is added already`); } names.push(name); if (opts instanceof Function) { func = opts; opts = {}; fixtures = []; } if (fixtures instanceof Function) { func = fixtures; fixtures = []; } opts = opts || {}; fixtures = fixtures || []; opts.skip = U.defVal(opts.skip, false); opts.skipReason = U.defVal(opts.skipReason); opts.retry = U.defVal(opts.retry, CONF.testRetries, 0); opts.chunkRetry = U.defVal(opts.chunkRetry, CONF.chunkRetries, 0); opts.chunkTimeout = U.defVal(opts.chunkTimeout); var testCase = new TestCase(name); CONF.testCases.push(testCase); if (opts.skip) { testCase.status = TestCase.SKIPPED; if (opts.skipReason) testCase.addDetails(opts.skipReason); return; } var retries = opts.retry; var testFunc = ctxs =&gt; { ctxs = ctxs || [{}]; scope(name, opts, () =&gt; { before(() =&gt; { testCase.reset(); testCase.start(); CONF.curTestCase = testCase; setLog(); // Current test case is started, need to reinit log }); U.wrap(fixtures, () =&gt; { for (var ctx of ctxs) func(ctx); })(); after(() =&gt; { if (testCase.errors.length) { testCase.end(TestCase.FAILED); } else { testCase.end(TestCase.PASSED); } CONF.curTestCase = null; setLog(); // Current test case is finished, need to reinit log if (testCase.status !== TestCase.FAILED || retries &lt;= 0) { return; } retries--; var retryNum = opts.retry - retries; var sessName = `Retry #${retryNum}`; /* Hack to pass mocha grep */ var mochaRunner = hacking.getRunner(); if (mochaRunner._grep !== mochaRunner._defaultGrep) { sessName += &quot; - &quot; + mochaRunner._grep.source; } var sessCtx = { retryNumber: retryNum }; session(sessName, sessCtx, null, () =&gt; { testFunc(testCase.failedParams); }); }); }); }; testFunc(); }; })([]); /** * Executes test case. * * @global * @function * @arg {string} name - Name of test case. * @arg {object} [opts] - Options. * @arg {boolean} [opts.skip=false] - Flag to skip test. * @arg {string} [opts.skipReason=null] - Skip reason if test is marked as skipped. * @arg {number} [opts.retry=0] - Number of retries on failure. Overrides * config value for concrete test. * @arg {number} [opts.chunkRetry=0] - Number of chunk retries on failure. * Overrides config value for concrete test chunks. * @arg {?number} [opts.chunkTimeout=null] - Time to execute chunk or hook, sec. * @arg {function[]} [fixtures] - Involved fixtures list. * @arg {function} func - Test function. * @example test(&quot;Some test&quot;, () =&gt; { chunk(&quot;Some chunk&quot;, () =&gt; { someFunc(); }); }); */ var test = (name, opts, fixtures, func) =&gt; { if (opts instanceof Function) { func = opts; opts = {}; fixtures = []; } if (fixtures instanceof Function) { func = fixtures; fixtures = []; } opts = opts || {}; fixtures = fixtures || []; baseTest(name, opts, fixtures, ctx =&gt; { func(ctx); }); }; module.exports = test; × Search results Close "},"globals_chunk.js.html":{"id":"globals_chunk.js.html","title":"Source: globals/chunk.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/chunk.js /* global it */ &quot;use strict&quot;; var CONF = require(&quot;../config&quot;); /** * Defines test chunk. * * Contains actions and verifications, which will be executed separatly * from another chunks. This function is used to organize test * structure and to allocate independent test actions. * * @global * @function * @arg {string} [name] - Name of chunk. * @arg {object} [opts] - Chunk options. * @arg {number} [opts.retry] - Number of chunk retries on failure. * @arg {number} [opts.timeout] - Time limit to execute chunk, sec. * @arg {function} func - Callback function with test payload. * * @example &lt;caption&gt;&lt;b&gt;Anonymous chunk&lt;/b&gt;&lt;/caption&gt; * * test(&quot;My test&quot;, () =&gt; { * chunk(() =&gt; { * var a = 5; * expect(a).to.be.equal(2); * }); * }); * * @example &lt;caption&gt;&lt;b&gt;Named chunk&lt;/b&gt;&lt;/caption&gt; * * test(&quot;My test&quot;, () =&gt; { * chunk(&quot;My chunk&quot;, () =&gt; { * var a = 5; * expect(a).to.be.equal(2); * }); * }); * * @example &lt;caption&gt;&lt;b&gt;Chunk with options&lt;/b&gt;&lt;/caption&gt; * * test(&quot;My test&quot;, () =&gt; { * chunk(&quot;My chunk&quot;, { retry: 2, timeout: 1 }, () =&gt; { * var a = 5; * expect(a).to.be.equal(2); * }); * }); */ var chunk = (name, opts, func) =&gt; { if (name instanceof Function) { func = name; name = &quot;&quot;; opts = {}; } if (opts instanceof Function) { func = opts; opts = {}; } if (name instanceof Object) { opts = name; name = &quot;&quot;; } name = name || &quot;&quot;; opts = opts || {}; it(name, _chunkCb(name, opts, func)); }; /** * Chunk callback. * @ignore */ var _chunkCb = (name, opts, func) =&gt; function () { CONF.curTestCase.addChunk(name); if (opts.retry) this.retries(opts.retry); if (opts.timeout) this.timeout(opts.timeout * 1000); return func(); // return is required because function may return Promise }; module.exports = chunk; × Search results Close "},"globals_forEachLanguage.js.html":{"id":"globals_forEachLanguage.js.html","title":"Source: globals/forEachLanguage.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/forEachLanguage.js /* global scope before */ &quot;use strict&quot;; var U = require(&quot;glace-utils&quot;); var CONF = require(&quot;../config&quot;); /** * Iterates test chunks through all languages specified in config or options. * * It's applicable for multilingual application. If list of languages is * specified, it will be used firstly. Otherwise from configuration. * * @global * @function * @arg {object} [ctx] - Test case context. * @arg {object} [opts] - Options. * @arg {?string[]} [opts.languages] - List of tested languages. * @arg {function[]} [fixtures] - Involved fixtures list. * @arg {function} func - Function with test steps. * @example * * test(&quot;Some test&quot;, ctx =&gt; { * forEachLanguage(ctx, lang =&gt; { * chunk(() =&gt; { * // payload * }); * }); * }); */ var forEachLanguage = (ctx, opts, fixtures, func) =&gt; { if (ctx instanceof Function) { func = ctx; ctx = {}; opts = {}; fixtures = []; } if (opts instanceof Function) { func = opts; opts = {}; fixtures = []; } if (fixtures instanceof Function) { func = fixtures; fixtures = []; } ctx = ctx || {}; opts = opts || {}; fixtures = fixtures || []; var languages = ctx.language ? [ctx.language] : (opts.languages || CONF.languages); languages.forEach(_langCb(fixtures, func)); }; var _langCb = (fixtures, func) =&gt; lang =&gt; { scope(`for language &quot;${lang}&quot;`, () =&gt; { before(() =&gt; { if (CONF.curTestCase) { CONF.curTestCase.testParams.language = lang; } }); U.wrap(fixtures, () =&gt; func(lang))(); }); }; module.exports = forEachLanguage; × Search results Close "},"config.js.html":{"id":"config.js.html","title":"Source: config.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: config.js &quot;use strict&quot;; /** * Configures `GlaceJS` before tests run. * * @namespace GlaceConfig * @prop {?TestCase} curTestCase - Currently executed test. * @prop {TestCase[]} testCases - List of executed tests. * @prop {string[]} preloads - List of module paths which will be loaded before * test run. * @prop {string[]} [testDirs=cwd/tests] - List of folder or file paths with tests. * @prop {string} [reportsDir=cwd/reports] - Path to reports folder. * @prop {string} [logsDir=reportsDir] - Path to logs folder. * @prop {boolean} [debugOnFail=false] - Flag to enter to debug mode on test failure. * @prop {?boolean} [isRunPassed] - Whether test run is passed. * @prop {string[]} [languages=[]] - List of tested languages. * @prop {boolean} [clearReport=true] - Clear report before test run. * @prop {string} [uncaught=log] - Strategy to process uncaught exceptions. * @prop {string} [rootConftest] - Path to root conftest.js. * @prop {number} [testRetries=0] - Number of test retries on test failure. * @prop {number} [chunkRetries=0] - Number of chunk retries on chunk failure. * @prop {string} grep - Test name or name chunk to filter tests. * @prop {string} pluginsDir - Path to custom plugins folder. * @prop {string} [sessionName] - Name of tests session. * @prop {number} [sessionId] - ID of tests session. * @prop {?string[]} [killProcs] - List of process names which will be killed * before tests run. * @prop {object} testrail - TestRail reporter configuration. * @prop {boolean} [testrail.use=false] - Activate TestRail reporter. * @prop {?string} [testrail.host=null] - TestRail host. * @prop {?string} [testrail.user=null] - TestRail user. * @prop {?string} [testrail.token=null] - TestRail token. * @prop {?number} [testrail.projectId=null] - TestRail project ID. * @prop {?number} [testrail.suiteId=null] - TestRail suite ID. * @prop {?string} [testrail.runName=null] - TestRail run name. * @prop {?string} [testrail.runDescription=null] - TestRail run description. */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); require(&quot;colors&quot;); var _ = require(&quot;lodash&quot;); var expect = require(&quot;chai&quot;).expect; var U = require(&quot;glace-utils&quot;); var plugins = require(&quot;./plugins&quot;); var config = U.config; var args = config.args; if (args.plugins) { var noPlugins = true; for (var plugin of plugins.get()) { noPlugins = false; console.log(plugin.name.yellow, plugin.path.white); } if (noPlugins) console.log(&quot;No plugins are detected&quot;.yellow); process.exit(); } /* Set up test folders */ var targets; if (args._ &amp;&amp; args._.length) { targets = args._; } else if (args.targets &amp;&amp; args.targets.length) { targets = args.targets; } else { targets = [&quot;tests&quot;]; }; config = _.merge(config, { curTestCase: null, preloads: [], timeouts: { }, testCases: [], testDirs: targets.map(target =&gt; path.resolve(U.cwd, target)), reportsDir: path.resolve(U.cwd, (args.report || &quot;reports&quot;)), isRunPassed: null, languages: [] }); config.logsDir = config.reportsDir; /* Use CLI arguments */ config.debugOnFail = args.debugOnFail; config.timeouts.chunk = (args.chunkTimeout || 180) * 1000 || Infinity; config.clearReport = !args.dontClearReport; config.uncaught = (args.uncaught || &quot;log&quot;).toLowerCase(); expect([ &quot;log&quot;, &quot;fail&quot;, &quot;mocha&quot; ], &quot;Invalid `--uncaught` value&quot;).include(config.uncaught); if (args.rootConftest) { config.rootConftest = path.resolve(U.cwd, args.rootConftest); } config.testRetries = args.retry || 0; config.chunkRetries = args.chunkRetry || 0; expect(config.testRetries).gte(0); config.grep = args.g || args.grep; config.pluginsDir = args.pluginsDir; var date = new Date(); config.sessionName = U.defVal(args.sessionName, `Session ${date.toLocaleString()}`); config.sessionId = date.getTime(); if (args.killProcs) { config.killProcs = _.filter( _.map(args.killProcs.split(&quot;,&quot;), el =&gt; el.trim())); } config.xunit = U.defVal(config.xunit, {}); config.xunit.use = U.defVal(args.xunit, false); config.xunit.path = U.defVal(args.xunitPath, path.resolve(U.cwd, &quot;xunit.xml&quot;)); config.xunit.suiteName = U.defVal(args.xunitSuiteName, config.sessionName); config.testrail = U.defVal(config.testrail, {}); config.testrail.use = U.defVal(args.testrail, false); config.testrail.host = U.defVal(args.testrailHost); config.testrail.user = U.defVal(args.testrailUser); config.testrail.token = U.defVal(args.testrailToken); config.testrail.projectId = U.defVal(args.testrailProjectId); config.testrail.suiteId = U.defVal(args.testrailSuiteId); config.testrail.runName = U.defVal(args.testrailRunName); config.testrail.runDescription = U.defVal(args.testrailRunDesc); if (args.languages) { config.languages = _.filter(_.map(args.languages.split(&quot;,&quot;), el =&gt; el.trim())); } /* Load plugins configs */ plugins.getModules(&quot;config&quot;); /* Merge user config */ var userConfig = {}; var userConfigPath = path.resolve(U.cwd, (args.userConfig || &quot;config.js&quot;)); if (fs.existsSync(userConfigPath)) { userConfig = require(userConfigPath); } _.assign(config, userConfig); module.exports = config; × Search results Close "},"reporter_base.js.html":{"id":"reporter_base.js.html","title":"Source: reporter/base.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: reporter/base.js &quot;use strict&quot;; /** * `GlaceJS` common reporter. * * @class * @name GlaceReporter * @arg {object} runner - `MochaJS` runner. */ var _ = require(&quot;lodash&quot;); var fs = require(&quot;fs&quot;); var util = require(&quot;util&quot;); var MochaReporter = require(&quot;mocha&quot;).reporters.base; var U = require(&quot;glace-utils&quot;); var LOG = U.logger; var CONF = require(&quot;../config&quot;); /** * Registered reporters. * * @type {object[]} */ var reporters = []; var GlaceReporter = function (runner) { MochaReporter.call(this, runner); runner.on(&quot;start&quot;, () =&gt; { for (var reporter of reporters) { if (reporter.start) reporter.start(); } }); runner.on(&quot;end&quot;, () =&gt; { if (fs.existsSync(CONF.reportsDir)) { U.clearEmptyFolders(CONF.reportsDir); } for (var reporter of reporters) { if (reporter.end) reporter.end(); } }); runner.on(&quot;suite&quot;, mochaSuite =&gt; { var isTest = _isSuiteTest(mochaSuite); for (var reporter of reporters) { if (isTest) { if (reporter.test) reporter.test(mochaSuite); } else { if (reporter.scope) reporter.scope(mochaSuite); } } }); runner.on(&quot;suite end&quot;, mochaSuite =&gt; { var isTest = _isSuiteTest(mochaSuite); for (var reporter of reporters) { if (isTest) { if (reporter.testEnd) reporter.testEnd(mochaSuite); } else { if (reporter.scopeEnd) reporter.scopeEnd(mochaSuite); } } }); runner.on(&quot;test&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.chunk) reporter.chunk(mochaTest); } }); runner.on(&quot;test end&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.chunkEnd) reporter.chunkEnd(mochaTest); } }); runner.on(&quot;hook&quot;, mochaHook =&gt; { for (var reporter of reporters) { if (reporter.hook) reporter.hook(mochaHook); } }); runner.on(&quot;hook end&quot;, mochaHook =&gt; { for (var reporter of reporters) { if (reporter.hookEnd) reporter.hookEnd(mochaHook); } }); runner.on(&quot;pass&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.pass) reporter.pass(mochaTest); } }); runner.on(&quot;fail&quot;, (mochaTest, err) =&gt; { CONF.isRunPassed = false; if (CONF.curTestCase) { var errMsg = mochaTest.title; if (err.message) { errMsg += &quot;\\nmessage: &quot; + err.message; } if (err.stack) { errMsg += &quot;\\nstack: &quot; + err.stack; } if (err.seleniumStack) { errMsg += &quot;\\nselenium: &quot; + JSON.stringify(err.seleniumStack, null, &quot;\\t&quot;); } CONF.curTestCase.addError(errMsg); CONF.curTestCase.addFailedParams( _.clone(CONF.curTestCase.testParams)); } for (var reporter of reporters) { if (reporter.fail) reporter.fail(mochaTest, err); } }); runner.on(&quot;pending&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.pending) reporter.pending(mochaTest); } }); }; util.inherits(GlaceReporter, MochaReporter); module.exports = GlaceReporter; /** * Finalizes reporting. * * @function * @async * @arg {Array.&lt;*&gt;} failures - Tests failures. * @arg {function} fn - Finalizator. */ GlaceReporter.prototype.done = function (failures, fn) { var prms = Promise.resolve(); reporters.forEach(reporter =&gt; { if (reporter.done) { prms = prms .then(() =&gt; reporter.done()) .catch(e =&gt; LOG.error(e)); } }); prms.then(() =&gt; fn(failures)); }; /** * Registers reporters if they are not. * * @method * @static * @arg {...object} reporters - Sequence of reporters to register. */ GlaceReporter.register = function () { for (var reporter of arguments) { if (!reporters.includes(reporter)) { reporters.push(reporter); } } }; /** * Removes reporters if they are registered. * * @method * @static * @arg {...object} reporters - Sequence of reporters to remove. */ GlaceReporter.remove = function () { reporters = _.without.apply(_, reporters, arguments); }; /** * Helper to define whether `MochaJS` suite is `GlaceJS` test or no. * * It iterates among registered tests and check if suite name matches name * someone of tests. It is not possible to use `CONF.curTestCase` to compare * because `CONF.curTestCase` is assigned after event `suite`. * * @function * @ignore * @arg {object} mochaSuite - `MochaJS` suite. * @return {boolean} - `true` if `MochaJS` suite is `GlaceJS` test, `false` * otherwise. */ var _isSuiteTest = mochaSuite =&gt; { for (var testCase of CONF.testCases) { if (mochaSuite.title === testCase.name) { return true; } } return false; }; × Search results Close "},"help.js.html":{"id":"help.js.html","title":"Source: help.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: help.js &quot;use strict&quot;; /** * Help description. * * @function * @name help * @arg {function} d - Function to process option description. * @arg {function} cb - Callback to expand default help. */ require(&quot;colors&quot;); var U = require(&quot;glace-utils&quot;); var plugins = require(&quot;./plugins&quot;); module.exports = (d, cb) =&gt; { d = d || U.switchColor(); cb = cb || (o =&gt; o); var result = U.help(d) .usage(&quot;\\nglace [options] [sequence-of-test-files-or-folders]&quot;.white.bold) .options({ /* configuration */ &quot;user-config [path]&quot;: { describe: d(&quot;Path to JS file with configuration which will be&quot;, &quot;merged with override default configuration.&quot;, &quot;Default is 'cwd/config.js' (if it exists).&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;session-name [name]&quot;: { describe: d(&quot;Tests run session name.&quot;, &quot;Default value includes word 'session' and datetime.&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;grep &lt;pattern&gt;&quot;: { alias: &quot;g&quot;, describe: d(&quot;Filter tests by name or name chunk.&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;report [path]&quot;: { describe: d(&quot;Path to reports folder. Default is 'cwd/reports'.&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;dont-clear-report&quot;: { describe: d(&quot;Don't clear previous report on tests run.&quot;), type: &quot;boolean&quot;, group: &quot;Core:&quot;, }, &quot;root-conftest &lt;path&gt;&quot;: { describe: d(&quot;Path to root conftest.js which will be loaded&quot;, &quot;before all.&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;languages &lt;sequence&gt;&quot;: { describe: d(&quot;List of tested languages separated with comma.&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;retry [times]&quot;: { describe: d(&quot;Number of times to retry failed test.&quot;, &quot;Default is 0.&quot;), type: &quot;number&quot;, group: &quot;Core:&quot;, }, &quot;chunk-retry [times]&quot;: { describe: d(&quot;Number of times to retry failed chunk.&quot;, &quot;Default is 0.&quot;), type: &quot;number&quot;, group: &quot;Core:&quot;, }, &quot;chunk-timeout [sec]&quot;: { describe: d(&quot;Time to execute chunk or hook, sec.&quot;, &quot;Default is 180.&quot;), type: &quot;number&quot;, group: &quot;Core:&quot;, }, &quot;uncaught [type]&quot;: { describe: d(&quot;Strategy to process uncaught exceptions.&quot;, &quot;Default value is 'log'. See details in&quot;, &quot;https://glacejs.github.io/glace-core&quot;), type: &quot;string&quot;, choices: [ &quot;log&quot;, &quot;fail&quot;, &quot;mocha&quot; ], group: &quot;Core:&quot;, }, &quot;kill-procs &lt;sequence&gt;&quot;: { describe: d(&quot;List of process names separated with comma,&quot;, &quot;which will be killed before tests run.&quot;), type: &quot;string&quot;, group: &quot;Core:&quot;, }, &quot;debug-on-fail&quot;: { describe: d(&quot;Enter to interactive debug mode on step failure.&quot;), type: &quot;boolean&quot;, group: &quot;Core:&quot;, }, /* plugins */ &quot;plugins&quot;: { describe: d(&quot;Show plugins only.&quot;), type: &quot;boolean&quot;, group: &quot;Plugins:&quot;, }, &quot;plugins-dir [path]&quot;: { describe: d(&quot;Path to custom plugins folder. By default it searches&quot;, &quot;plugins inside folder, where 'glace-core' is installed.&quot;), type: &quot;string&quot;, group: &quot;Plugins:&quot;, }, &quot;disable-default-plugins&quot;: { describe: d(&quot;Disable default plugins.&quot;), type: &quot;boolean&quot;, group: &quot;Plugins:&quot;, }, /* xunit */ &quot;xunit&quot;: { describe: d(&quot;Activate xUnit reporter.&quot;), type: &quot;boolean&quot;, group: &quot;xUnit:&quot;, }, &quot;xunit-path [path]&quot;: { describe: d(&quot;Path to xUnit report. Default is 'cwd/xunit.xml'.&quot;), type: &quot;string&quot;, group: &quot;xUnit:&quot;, }, &quot;xunit-suite-name [name]&quot;: { describe: d(&quot;Tests suite name in xUnit report.&quot;, &quot;By default it's the same as session name.&quot;), type: &quot;string&quot;, group: &quot;xUnit:&quot;, }, /* testrail */ &quot;testrail&quot;: { describe: d(&quot;Activate testrail reporter.&quot;), type: &quot;boolean&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-host &lt;host&gt;&quot;: { describe: d(&quot;TestRail host.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-user &lt;user&gt;&quot;: { describe: d(&quot;TestRail username or email.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-token &lt;token&gt;&quot;: { describe: d(&quot;TestRail token.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-project-id &lt;id&gt;&quot;: { describe: d(&quot;TestRail project id.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-suite-id &lt;id&gt;&quot;: { describe: d(&quot;TestRail suite id.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-run-name &lt;name&gt;&quot;: { describe: d(&quot;TestRail run name.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, &quot;testrail-run-desc &lt;description&gt;&quot;: { describe: d(&quot;TestRail run description.&quot;), type: &quot;string&quot;, group: &quot;TestRail:&quot;, }, }); for (var help of plugins.getModules(&quot;pluginHelp&quot;)) { result = help(result, d); } result = cb(result); result.epilog(&quot;Have a green test ;)&quot;.green.bold).argv; }; × Search results Close "},"cli.js.html":{"id":"cli.js.html","title":"Source: cli.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: cli.js &quot;use strict&quot;; /** * Contains functions to execute tests via command line interface. * * @module */ var run = require(&quot;./run&quot;); /* allow plugins registration in runner before help call */ require(&quot;./help&quot;)(); /** * Runs `GlaceJS` in CLI. * * @function */ module.exports.run = () =&gt; run(process.exit); × Search results Close "},"error.js.html":{"id":"error.js.html","title":"Source: error.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: error.js &quot;use strict&quot;; /** * Contains `GlaceJS` errors. * * @module */ var util = require(&quot;util&quot;); var GlaceError = require(&quot;glace-utils&quot;).GlaceError; /** * Error which is thrown when configuration is wrong. * * @class * @arg {string} message - Error message. */ var ConfigError = module.exports.ConfigError = function (message) { GlaceError.call(this, message); }; util.inherits(ConfigError, GlaceError); /** * Error which is thrown when step execution is wrong. * * @class * @arg {string} message - Error message. */ var StepError = module.exports.StepError = function (message) { GlaceError.call(this, message); }; util.inherits(StepError, GlaceError); × Search results Close "},"hacking.js.html":{"id":"hacking.js.html","title":"Source: hacking.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: hacking.js &quot;use strict&quot;; /** * Contains hacks for test run. * * @module */ var LOG = require(&quot;glace-utils&quot;).logger; var Mocha = require(&quot;mocha&quot;); var Pending = require(&quot;mocha/lib/pending&quot;); var CONF = require(&quot;./config&quot;); /** * Patches original `Mocha.Runner.prototype.uncaught` in order to skip * exceptions from proxy server `res.send()`. * * @function */ module.exports.suppressMochaUncaught = () =&gt; { Mocha.Runner.prototype.uncaught = function (err) { LOG.error(&quot;UNCAUGHT EXCEPTION&quot;, err); if (CONF.uncaught === &quot;fail&quot;) { if (CONF.curTestCase) { var errMsg = &quot;Uncaught exception&quot;; if (err.message) { errMsg += &quot;\\nmessage: &quot; + err.message; } if (err.stack) { errMsg += &quot;\\nstack: &quot; + err.stack; } if (err.seleniumStack) { errMsg += &quot;\\nselenium: &quot; + JSON.stringify(err.seleniumStack, null, &quot;\\t&quot;); } CONF.curTestCase.addError(errMsg); } } return; }; }; /** * Mocha runner. * * @type {Runner} */ var _mochaRunner; (grep =&gt; { Mocha.Runner.prototype.grep = function() { _mochaRunner = this; return grep.apply(this, arguments); }; })(Mocha.Runner.prototype.grep); /** * Gets mocha runner. * * @function */ module.exports.getRunner = () =&gt; _mochaRunner; /** * Patches mocha runner to allow multiple independent `after`-calls. */ Mocha.Runner.prototype.hook = function (name, fn) { var suite = this.suite; var hooks = suite[&quot;_&quot; + name]; var self = this; function next (i) { var hook = hooks[i]; if (!hook) { return fn(); } self.currentRunnable = hook; hook.ctx.currentTest = self.test; self.emit(&quot;hook&quot;, hook); if (!hook.listeners(&quot;error&quot;).length) { hook.on(&quot;error&quot;, function (err) { self.failHook(hook, err); }); } hook.run(function (err) { var testError = hook.error(); if (testError) { self.fail(self.test, testError); } if (err) { if (err instanceof Pending) { if (name === &quot;beforeEach&quot; || name === &quot;afterEach&quot;) { self.test.pending = true; } else { suite.tests.forEach(function (test) { test.pending = true; }); // a pending hook won't be executed twice. hook.pending = true; } } else { self.failHook(hook, err); // stop executing hooks, notify callee of hook err if (!name.startsWith(&quot;after&quot;)) return fn(err); } } self.emit(&quot;hook end&quot;, hook); delete hook.ctx.currentTest; next(++i); }); } Mocha.Runner.immediately(function () { next(0); }); }; × Search results Close "},"index.js.html":{"id":"index.js.html","title":"Source: index.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: index.js &quot;use strict&quot;; /** * `GlaceJS` main module. * * @module * * @prop {object} config - {@link module:config|Config} module. * @prop {object} error - {@link module:error|Error} module. * @prop {function} help - {@link module:help|Help} module. * @prop {object} reporter - {@link module:reporter/index|Reporter} module. * @prop {object} run - {@link module:run|run} module. * @prop {object} Steps - {@link module:steps|Steps} module. */ var config, error, help, plugins, reporter, run, Steps; Object.defineProperties(exports, { /** * @type {GlaceConfig} */ config: { get: function() { config = config || require(&quot;./config&quot;); return config; }, }, error: { get: function() { error = error || require(&quot;./error&quot;); return error; }, }, /** * Help. */ help: { get: function () { help = help || require(&quot;./help&quot;); return help; }, }, plugins: { get: function () { plugins = plugins || require(&quot;./plugins&quot;); return plugins; }, }, /** * @type {GlaceReporter} */ reporter: { get: function() { reporter = reporter || require(&quot;./reporter&quot;); return reporter; }, }, /** * @type {run} */ run: { get: function() { run = run || require(&quot;./run&quot;); return run; }, }, /** * @type {Steps} */ Steps: { get: function() { Steps = Steps || require(&quot;./steps&quot;); return Steps; }, }, }); × Search results Close "},"loader.js.html":{"id":"loader.js.html","title":"Source: loader.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: loader.js /* global before session */ &quot;use strict&quot;; /** * Makes tests root session. * * - runner loads root `conftest.js` if it is located on one level with * each of `CONF.testDirs`; * - if each of `CONF.testDirs` is file with tests, runner loads and executes it; * - if each of `CONF.testDirs` is folder runner loads files inside recursive if * file name starts with `test` and ends with `.js`; * - inside each subfolder of each of `CONF.testDirs` runner loads `conftest.js` * file if it is present; * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var expect = require(&quot;chai&quot;).expect; var U = require(&quot;glace-utils&quot;); require(&quot;./globals&quot;); var CONF = require(&quot;./config&quot;); var ConfigError = require(&quot;./error&quot;).ConfigError; /** * Loads special `preloads` files before main conftests and test files. * * Preloads are specified in `CONF.preloads` array. It may be managed only * programmatically and needs as extension point to load some custom files * before tests. * * After preloads it loads root (the mainest) conftest file, which may be set * via CLI. */ var preloads = () =&gt; { var pre = _.clone(CONF.preloads); if (CONF.rootConftest &amp;&amp; !pre.includes(CONF.rootConftest)) { pre.push(CONF.rootConftest); } for (var preload of pre) { expect( fs.existsSync(preload) &amp;&amp; fs.statSync(preload).isFile(), `Preloader '${preload}' isn't a file or doesn't exist` ).to.be.true; require(preload); } }; /** * Main conftests are loaded before tests session creation and may used for * objects management, for example to created custom instance of global `SS`. * * Main conftest is `conftest.js` file which is located on one hierarchy level * with each specified tests folder or file. */ var mainConftests = () =&gt; { for (var testDir of CONF.testDirs) { if (!fs.existsSync(testDir)) { throw new ConfigError( `Tests file or folder '${testDir}' doesn't exist`); } var siblingConftest = path.resolve(path.dirname(testDir), &quot;conftest.js&quot;); if (fs.existsSync(siblingConftest)) { require(siblingConftest); } } }; /** * Callback to create tests session. * * It kills some processes before all if they are specified. */ var sessFunc = () =&gt; { if (CONF.killProcs) { before(async () =&gt; { for (var procName of CONF.killProcs) { await U.killProcs(procName); } }); } for (var testDir of CONF.testDirs) { if (!fs.statSync(testDir).isDirectory()) { require(testDir); continue; } loadTests(testDir); } }; /** * Loads test files recursively. Test file name should start with `test` and * end with `.js`. * * @function * @arg {string} dir - Folder with test files. */ var loadTests = dir =&gt; { for (var fileName of fs.readdirSync(dir)) { var filePath = path.resolve(dir, fileName); var fileStat = fs.statSync(filePath); if (fileStat.isDirectory()) { loadTests(filePath); } if (fileStat.isFile()) { if (fileName === &quot;conftest.js&quot;) require(filePath); if (fileName.startsWith(&quot;test&quot;) &amp;&amp; fileName.endsWith(&quot;.js&quot;)) { require(filePath); } } } }; /* Starts session */ preloads(); mainConftests(); session(sessFunc); × Search results Close "},"matcher.js.html":{"id":"matcher.js.html","title":"Source: matcher.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: matcher.js &quot;use strict&quot;; /** * Matchers. * * @module */ var _ = require(&quot;lodash&quot;); var Assertion = require(&quot;chai&quot;).Assertion; var U = require(&quot;glace-utils&quot;); /** * Checks expectation corresponds to condition. * * @method * @arg {string} cond - conditions for assertion. * @arg {string} [msg] - message to throw in case of wrong conditions. * @example await SS.checkBalance({ &quot;to be not equal&quot;: 100 }) Steps.prototype.checkBalance = async function (condition) { var currBalance = await this.getBalance(); expect(currBalance).correspond(condition, &quot;Invalid user balance&quot;); }; */ Assertion.prototype.correspond = function (cond, msg) { var matchers, expVal; if (msg) this.__flags.message = msg; if (typeof(cond) === &quot;object&quot;) { if (Object.keys(cond).length !== 1) { throw new Error(&quot;Condition should contain only one key-value pair&quot;); } matchers = Object.keys(cond)[0]; expVal = Object.values(cond)[0]; } else if (typeof(cond) === &quot;string&quot;) { matchers = cond; } else { throw new Error(&quot;Condition should be string or object only&quot;); } matchers = _.filter(_.split(matchers, &quot; &quot;)); var predicate = this; for (var matcher of matchers) { predicate = predicate[matcher]; if (!predicate) throw new TypeError(`Undefined matcher '${matcher}'`); } if (expVal) predicate.call(this, expVal); return this; }; /** * Checks expectation corresponds to condition during timeout. * * @arg {string|object} cond - Condition for assertion. * @arg {number} [timeout=1] - Timeout to wait for matching. * @arg {string} [msg] - Error message. * @throws {Error} If condition wasn't matched during timeout. */ Assertion.prototype.waitFor = async function (cond, timeout, msg) { var err = null; var predicate = async () =&gt; { try { return await new Assertion( await this.__flags.object(), this.__flags.message).correspond(cond, msg); } catch (e) { err = e; return false; } }; var result = await U.waitFor(predicate, { timeout: timeout }); if (result) return this; if (err) { throw err; } else { throw new Error(&quot;Unexpected matcher error&quot;); } }; × Search results Close "},"plugins.js.html":{"id":"plugins.js.html","title":"Source: plugins.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: plugins.js &quot;use strict&quot;; /** * Plugins. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var expect = require(&quot;chai&quot;).expect; var U = require(&quot;glace-utils&quot;); var args = U.config.args; var LOG = U.logger; var systemPlugins = null; // plugins cache var customPlugins = []; /** * Gets modules from plugins. * * @arg {string} moduleName - Name of module to request from plugins. * @return {object[]} - List of modules requested from plugins. */ module.exports.getModules = moduleName =&gt; { var modules = []; for (var plugin of Object.values(getPlugins())) { var mod = plugin.module[moduleName]; if (mod) modules.push(mod); } return modules; }; var getPlugins = module.exports.get = () =&gt; { if (!systemPlugins) { var fileName; systemPlugins = []; var systemNames = []; if (args.pluginsDir) { expect(fs.existsSync(args.pluginsDir), `Plugins folder '${args.pluginsDir}' doesn't exist`) .to.be.true; for (fileName of fs.readdirSync(args.pluginsDir).reverse()) { if (!systemNames.includes(fileName)) { systemNames.push(fileName); systemPlugins.push({ name: fileName, path: path.resolve(args.pluginsDir, fileName), }); } } } if (!args.disableDefaultPlugins) { var skipped = [ &quot;glace-js&quot;, &quot;glace-core&quot;, &quot;glace-utils&quot; ]; for (var pluginDir of _getPluginDirs()) { if (!fs.existsSync(pluginDir)) continue; for (fileName of fs.readdirSync(pluginDir).reverse()) { if (fileName.startsWith(&quot;glace-&quot;) &amp;&amp; !skipped.includes(fileName) &amp;&amp; !systemNames.includes(fileName)) { systemNames.push(fileName); systemPlugins.push({ name: fileName, path: path.resolve(pluginDir, fileName), }); } } } } systemPlugins.reverse(); for (var plugin of _.clone(systemPlugins)) { try { plugin.module = require(plugin.path); } catch (e) { LOG.warn(`Can't load plugin '${plugin.path}'`); systemPlugins.splice(systemPlugins.indexOf(plugin), 1); } } } var customNames = Object.values(customPlugins).map(p =&gt; p.name); return systemPlugins .filter(p =&gt; !customNames.includes(p.name)) .concat(customPlugins); }; /** * Clear plugins cache. * * @function */ module.exports.clearCache = () =&gt; systemPlugins = null; /** * Register custom plugin. * * @function * @arg {string} name - Name of plugin module. */ module.exports.register = name =&gt; { var customNames = Object.values(customPlugins).map(p =&gt; p.name); expect(customNames.includes(name), `Plugin '${name}' is registered already`) .to.be.false; customPlugins.push({ name: name, path: require.resolve(name), module: require(name), }); }; /** * Gets plugin dirs. * * @ignore * @function * @return {string[]} - List of paths. */ var _getPluginDirs = () =&gt; { var pluginDirs = _.clone(module.paths); if (require.main) { var mainDir = path.dirname(require.main.filename); if (!pluginDirs.includes(mainDir)) { pluginDirs.unshift(mainDir); } } if (!pluginDirs.includes(U.cwd)) { pluginDirs.unshift(U.cwd); } return pluginDirs; }; × Search results Close "},"reporter_index.js.html":{"id":"reporter_index.js.html","title":"Source: reporter/index.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: reporter/index.js &quot;use strict&quot;; /** * GlaceJS reporter package. * * @module */ var CONF = require(&quot;../config&quot;); var plugins = require(&quot;../plugins&quot;); var base = require(&quot;./base&quot;); base.register(require(&quot;./stdout&quot;)); if (CONF.testrail.use) base.register(require(&quot;./testrail&quot;)); if (CONF.xunit.use) base.register(require(&quot;./xunit&quot;)); for (var reporter of plugins.getModules(&quot;reporter&quot;)) { base.register(reporter); } module.exports = base; × Search results Close "},"reporter_stdout.js.html":{"id":"reporter_stdout.js.html","title":"Source: reporter/stdout.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: reporter/stdout.js &quot;use strict&quot;; /** * `GlaceJS` stdout reporter. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var util = require(&quot;util&quot;); var colors = require(&quot;colors&quot;); var MochaReporter = require(&quot;mocha&quot;).reporters.base; var CONF = require(&quot;../config&quot;); var TestCase = require(&quot;../testing&quot;).TestCase; var sessionErrors = []; var indents = 0; var indent = () =&gt; Array(indents).join(&quot; &quot;); var report = fs.createWriteStream( path.resolve(process.cwd(), &quot;report.log&quot;), { flags : &quot;w&quot; }); var stdout = function() { report.write(colors.strip(util.format.apply(util, arguments)) + &quot;\\n&quot;); console.log.apply(console, arguments); }; var epilogue = () =&gt; { var msg, testCase, indent = &quot; &quot;, passedTests = [], failedTests = [], skippedTests = []; for (testCase of CONF.testCases) { if (testCase.status === TestCase.FAILED) { failedTests.push(testCase); } if (testCase.status === TestCase.PASSED) { passedTests.push(testCase); } if (testCase.status === TestCase.SKIPPED) { skippedTests.push(testCase); } } if (passedTests.length !== 0) { msg = &quot;passed test&quot; + (passedTests.length === 1 ? &quot;&quot; : &quot;s&quot;); stdout((indent + MochaReporter.symbols.ok + &quot; &quot; + String(passedTests.length).bold + &quot; &quot; + msg).green); } if (failedTests.length !== 0) { msg = &quot;failed test&quot; + (failedTests.length === 1 ? &quot;&quot; : &quot;s&quot;); stdout((indent + MochaReporter.symbols.err + &quot; &quot; + String(failedTests.length).bold + &quot; &quot; + msg).red); } var execChunks = CONF.testCases.reduce((a, b) =&gt; a + b.chunks.length, 0); if (execChunks !== 0) { msg = &quot;executed chunk&quot; + (execChunks === 1 ? &quot;&quot; : &quot;s&quot;); stdout((indent + execChunks + &quot; &quot; + msg).white); } var execTime = CONF.testCases .map(t =&gt; t.duration) .reduce((a, b) =&gt; a + b, 0) / 1000; if (execTime &gt; 0) { stdout(); stdout(indent + &quot;Summary tests time is&quot;.white, `${execTime} sec`.white.bold); } if (skippedTests.length !== 0) { msg = &quot;skipped test&quot; + (skippedTests.length === 1 ? &quot;&quot; : &quot;s&quot;); stdout(); stdout((indent + &quot;# &quot; + String(skippedTests.length).bold + &quot; &quot; + msg).gray); for (var skip of skippedTests) { msg = `* '${skip.name}'`; if (skip.rawInfo[0]) { msg += &quot; - &quot; + skip.rawInfo[0].bold; } stdout(indent + indent + msg.gray); } } if (failedTests.length) { stdout(); stdout(&quot;TEST FAILURES:&quot;.bold); for (testCase of failedTests) { stdout(); stdout((&quot;test: &quot; + testCase.name).cyan.bold); for(var err of testCase.errors) { stdout(); stdout(err.red.bold); } } } if (sessionErrors.length) { stdout(); stdout(&quot;OUTTEST FAILURES:&quot;.bold); for (var error of sessionErrors) { stdout(); stdout(error.red.bold); } } }; module.exports = { /** * Called before tests end. * * @method * @instance */ end: () =&gt; { epilogue(); stdout(); var reportMsg = &quot;Local report is &quot; + CONF.reportsDir; stdout(Array(reportMsg.length + 1).join(&quot;-&quot;).yellow); stdout(reportMsg.yellow); }, /** * Called on scope start. * * @method * @instance * @arg {object} scope - `MochaJS` suite. */ scope: scope =&gt; { ++indents; if (indents !== 1) { stdout(); stdout((indent() + &quot;scope: &quot; + scope.title).cyan); } }, /** * Called before scope end. * * @method * @instance */ scopeEnd: () =&gt; { --indents; if (indents === 1) stdout(); }, /** * Called on test start. * * @method * @instance * @arg {object} test - `MochaJS` suite. */ test: test =&gt; { ++indents; stdout(); stdout((indent() + &quot;test: &quot; + test.title).cyan.bold); }, /** * Called on test end. * * @method * @instance */ testEnd: () =&gt; { --indents; if (indents === 1) stdout(); }, /** * Called on chunk passed. * * @method * @instance * @arg {object} chunk - `MochaJS` test. */ pass: chunk =&gt; { var msg = indent() + &quot; &quot; + MochaReporter.symbols.ok + &quot; chunk&quot;; if (chunk.title) msg += &quot;: &quot; + chunk.title; stdout(msg.green); }, /** * Called on chunk or hook failed. * * @method * @instance * @arg {object} chunk - `MochaJS` test. */ fail: (chunk, err) =&gt; { if (!CONF.curTestCase) { var errMsg = chunk.title; if (err.message) { errMsg += &quot;\\nmessage: &quot; + err.message; } if (err.stack) { errMsg += &quot;\\nstack: &quot; + err.stack; } if (err.seleniumStack) { errMsg += &quot;\\nselenium: &quot; + JSON.stringify(err.seleniumStack, null, &quot;\\t&quot;); } sessionErrors.push(errMsg); } var msg = indent() + &quot; &quot; + MochaReporter.symbols.err + &quot; chunk&quot;; if (chunk.title) msg += &quot;: &quot; + chunk.title; stdout(msg.red); }, /** * Called on report finalizing. * * @method * @instance */ done: () =&gt; new Promise(resolve =&gt; report.end(resolve)), }; × Search results Close "},"reporter_testrail.js.html":{"id":"reporter_testrail.js.html","title":"Source: reporter/testrail.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: reporter/testrail.js &quot;use strict&quot;; /** * TestRail reporter. * * @module */ var expect = require(&quot;chai&quot;).expect; var Testrail = require(&quot;testrail-api&quot;); var CONF = require(&quot;../config&quot;); var TestCase = require(&quot;../testing&quot;).TestCase; for (var opt in CONF.testrail) { expect(CONF.testrail[opt], `TestRail option '${opt}' isn't specified in config`) .to.exist; } var testrail = new Testrail({ host: CONF.testrail.host, user: CONF.testrail.user, password: CONF.testrail.token }); var testrailFailed = false; var Results = { PASSED: 1, BLOCKED: 2, UNTESTED: 3, RETEST: 4, FAILED: 5 }; var cases = {}; var report = Promise.resolve(); module.exports = { /** * Called on tests start. * * @method * @instance */ start: () =&gt; { report = report.then(() =&gt; { return new Promise((resolve, reject) =&gt; { testrail.getCases( CONF.testrail.projectId, { suite_id: CONF.testrail.suiteId }, (err, _cases) =&gt; { if (err) return reject(err); for (var _case of _cases) { if (cases[_case.title]) { return reject(new Error( &quot;Detect duplicated cases with name &quot; + `'${_case.title}'. Only unique names ` + &quot;should be.&quot;)); } cases[_case.title] = { id: _case.id }; } resolve(); }); }); }).then(() =&gt; { return new Promise((resolve, reject) =&gt; { testrail.addRun( CONF.testrail.projectId, { suite_id: CONF.testrail.suiteId, name: CONF.testrail.runName, description: CONF.testrail.runDescription }, (err, run) =&gt; { if (err) return reject(err); CONF.testrail.runId = run.id; resolve(); }); }); }) .catch(e =&gt; { testrailFailed = true; console.log(&quot;Error to init TestRail report:&quot;, e); }); }, /** * Called before tests end. * * @method * @instance */ end: () =&gt; { if (testrailFailed) return; console.log(); var reportMsg = &quot;TestRail report is &quot; + CONF.testrail.host + &quot;/index.php?/runs/view/&quot; + CONF.testrail.runId; console.log(Array(reportMsg.length + 1).join(&quot;-&quot;).yellow); console.log(reportMsg.yellow); }, /** * Called on test end. * * @method * @instance * @arg {object} test - `MochaJS` suite. */ testEnd: test =&gt; { if (testrailFailed) return; var testCase = CONF.testCases.filter(t =&gt; t.name === test.title)[0]; var testrailCase = cases[test.title]; if (!testrailCase) return; var testResult = { status_id: Results.PASSED, comment: &quot;&quot; }; if (testCase.screenshots.length) { testResult.comment += &quot;Screenshots:&quot;; for (var screen of testCase.screenshots) { testResult.comment += &quot;\\n&quot; + screen; } } if (testCase.videos.length) { testResult.comment += &quot;\\n\\nVideos:&quot;; for (var video of testCase.videos) { testResult.comment += &quot;\\n&quot; + video; } } if (testCase.rawInfo.length) { testResult.comment += &quot;\\n\\nExtra details:&quot;; for (var info of testCase.rawInfo) { testResult.comment += &quot;\\n&quot; + info; } } if (testCase.status === TestCase.SKIPPED) { testResult.status_id = Results.BLOCKED; } if (testCase.status === TestCase.FAILED) { testResult.status_id = Results.FAILED; testResult.comment += &quot;\\n\\nErrors:&quot;; for (var error of testCase.errors) { testResult.comment += &quot;\\n&quot; + error; } } report = report.then(() =&gt; { return new Promise((resolve, reject) =&gt; { testrail.addResultForCase( CONF.testrail.runId, testrailCase.id, testResult, (err, res) =&gt; { if (err) return reject(err); resolve(res); }); }); }).catch(e =&gt; { console.log( `Error to publish test '${test.title}' report to TestRail:`, e); }); }, /** * Called on report finalizing. * * @method * @instance */ done: () =&gt; report, }; × Search results Close "},"reporter_xunit.js.html":{"id":"reporter_xunit.js.html","title":"Source: reporter/xunit.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: reporter/xunit.js &quot;use strict&quot;; /** * `GlaceJS` xunit reporter. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); require(&quot;colors&quot;); var escape = require(&quot;mocha&quot;).utils.escape; var fse = require(&quot;fs-extra&quot;); var CONF = require(&quot;../config&quot;); var TestCase = require(&quot;../testing&quot;).TestCase; var stream; module.exports = { start: () =&gt; { if (fs.existsSync(CONF.xunit.path)) { fs.unlinkSync(CONF.xunit.path); } }, end: () =&gt; { fse.mkdirsSync(path.dirname(CONF.xunit.path)); stream = fs.createWriteStream(CONF.xunit.path); write(tag(&quot;testsuite&quot;, { name: CONF.xunit.suiteName, tests: CONF.testCases.length, failures: CONF.testCases.filter(t =&gt; t.status === TestCase.FAILED).length, errors: CONF.testCases.filter(t =&gt; t.status === TestCase.FAILED).length, skipped: CONF.testCases.filter(t =&gt; t.status === TestCase.SKIPPED).length, timestamp: new Date().toUTCString(), time: (CONF.testCases.map(t =&gt; t.duration).reduce((a, b) =&gt; a + b, 0) / 1000) || 0 }, false)); CONF.testCases.forEach(t =&gt; writeTest(t)); write(&quot;&lt;/testsuite&gt;&quot;); console.log(); var reportMsg = &quot;xUnit report is &quot; + CONF.xunit.path; console.log(Array(reportMsg.length + 1).join(&quot;-&quot;).yellow); console.log(reportMsg.yellow); }, done: () =&gt; new Promise(resolve =&gt; stream.end(resolve)), }; /** * Writes a line. * * @arg {string} line - Report text line. */ var write = line =&gt; { stream.write(line + &quot;\\n&quot;); }; /** * Writes a test. * * @arg {TestCase} test - Test case. */ var writeTest = test =&gt; { var attrs = { classname: test.name, name: test.name, time: (test.duration / 1000) || 0 }; if (test.status === TestCase.FAILED) { var err = test.errors.join(&quot;\\n&quot;); write(tag(&quot;testcase&quot;, attrs, false, tag(&quot;failure&quot;, {}, false, escape(err)))); } else if (test.status === TestCase.SKIPPED) { write(tag(&quot;testcase&quot;, attrs, false, tag(&quot;skipped&quot;, {}, true))); } else { write(tag(&quot;testcase&quot;, attrs, true)); } }; /** * HTML tag helper. (copied from mochajs) * * @ignore * @param name * @param attrs * @param close * @param content * @return {string} */ function tag (name, attrs, close, content) { var end = close ? &quot;/&gt;&quot; : &quot;&gt;&quot;; var pairs = []; var tag; for (var key in attrs) { if (Object.prototype.hasOwnProperty.call(attrs, key)) { pairs.push(key + &quot;=\\&quot;&quot; + escape(attrs[key]) + &quot;\\&quot;&quot;); } } tag = &quot;&lt;&quot; + name + (pairs.length ? &quot; &quot; + pairs.join(&quot; &quot;) : &quot;&quot;) + end; if (content) { tag += content + &quot;&lt;/&quot; + name + end; } return tag; } × Search results Close "},"testing.js.html":{"id":"testing.js.html","title":"Source: testing.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: testing.js &quot;use strict&quot;; /** * Contains classes and functions to save executed tests data. * * @module */ var _ = require(&quot;lodash&quot;); var expect = require(&quot;chai&quot;).expect; /** * Test case data structure. * * Contains full information and history about test case. * * @class * @arg {string} name - Test name. * @prop {string} name - Test name. * @prop {status} [status=NOT_STARTED] - Test status. * @prop {string[]} [screenshots=[]] - List of test screenshot paths. * @prop {string[]} [videos=[]] - List of test video paths. * @prop {string[]} [errors=[]] - List of test errors. * @prop {string[]} [rawInfo=[]] - List of additional test details. * @prop {object[]} [failedParams=[]] - List of test failed parameters. * @prop {object} [testParams={}] - Dict of test parameters. */ var TestCase = module.exports.TestCase = function (name) { this.duration = 0; this.name = name; this.status = TestCase.NOT_STARTED; this.chunks = []; this.reset(); }; /** * Starts test case. * * @method */ TestCase.prototype.start = function () { expect(this.status, `test case '${this.name}' is started already`) .to.not.be.equal(TestCase.IN_PROGRESS); this._startTime = new Date(); this.status = TestCase.IN_PROGRESS; }; /** * Ends test case. * * @method * @arg {string} status - Test case status. */ TestCase.prototype.end = function (status) { expect(this.status, `test case '${this.name}' isn't started yet`) .to.be.equal(TestCase.IN_PROGRESS); this.duration += new Date() - this._startTime; this.status = status; }; /** * Resets test case info. * * @method */ TestCase.prototype.reset = function () { this.screenshots = []; this.videos = []; this.errors = []; this.rawInfo = []; this.failedParams = []; this.testParams = {}; }; /** * Adds failed params if they don't exist. * * @method * @arg {object} params - Parameters which test was failed with. */ TestCase.prototype.addFailedParams = function (params) { for (var failed of this.failedParams) { if (_.isEqual(params, failed)) return; } this.failedParams.push(params); }; /** * Adds error to test case. * * @method * @arg {Error} err - Test error. */ TestCase.prototype.addError = function (err) { this.errors.push(err); }; /** * Adds screenshot. * * @method * @arg {string} imagePath - Path to saved screenshot. */ TestCase.prototype.addScreenshot = function (imagePath) { this.screenshots.push(imagePath); }; /** * Adds video. * * @method * @arg {string} videoPath - Path to saved video. */ TestCase.prototype.addVideo = function (videoPath) { this.videos.push(videoPath); }; /** * Adds additional information. * * @method * @arg {string} info - Additional information. */ TestCase.prototype.addDetails = function (info) { this.rawInfo.push(info); }; /** * Adds chunk. * * @method * @arg {string} chunkName - Name of chunk. */ TestCase.prototype.addChunk = function (chunkName) { this.chunks.push(chunkName); }; TestCase.NOT_STARTED = &quot;not started&quot;; TestCase.IN_PROGRESS = &quot;in progress&quot;; TestCase.FAILED = &quot;failed&quot;; TestCase.PASSED = &quot;passed&quot;; TestCase.SKIPPED = &quot;skipped&quot;; × Search results Close "},"globals_rewire.js.html":{"id":"globals_rewire.js.html","title":"Source: globals/rewire.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/rewire.js &quot;use strict&quot;; var path = require(&quot;path&quot;); var _rewire = require(&quot;rewire&quot;); /** * `rewire` is great lib for monkey patching, but it should be a bit patched too :) * * @global */ var rewire = filename =&gt; { var _ = Error.prepareStackTrace; Error.prepareStackTrace = (_, stack) =&gt; stack; var stack = new Error().stack.slice(1); Error.prepareStackTrace = _; var callerPath = stack[0].getFileName(); var callerDir = path.dirname(callerPath); filename = path.resolve(callerDir, filename); var mod = _rewire(filename); var cache = {}; var set = mod.__set__; mod.__set__ = function (name, stub) { if (!Object.keys(cache).includes(name)) { cache[name] = this.__get__(name); } set.call(this, name, stub); }; mod.__reset__ = function () { for (var [k, v] of Object.entries(cache)) { this.__set__(k, v); } cache = {}; }; return mod; }; module.exports = rewire; × Search results Close "},"run.js.html":{"id":"run.js.html","title":"Source: run.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: run.js &quot;use strict&quot;; /** * Runs tests. * * - executes `runner.js` file, which is entry point to load and execute * files with tests * - connects custom reporter to `mochajs`. * * @function * @name run * @arg {function} cb - Callback. */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var fse = require(&quot;fs-extra&quot;); var Mocha = require(&quot;mocha&quot;); var CONF = require(&quot;./config&quot;); var hacking = require(&quot;./hacking&quot;); var run = cb =&gt; { resetReport(); if (CONF.uncaught !== &quot;mocha&quot;) hacking.suppressMochaUncaught(); var mocha = new Mocha({ grep: CONF.grep, timeout: CONF.timeouts.chunk, retries: CONF.chunkRetries, reporter: path.resolve(__dirname, &quot;reporter&quot;) }); mocha.addFile(path.resolve(__dirname, &quot;loader.js&quot;)); if (cb) { _run(mocha, cb); } else { return new Promise(resolve =&gt; _run(mocha, resolve)); } }; /** * Runs mocha. * * @ignore */ var _run = (mocha, fin) =&gt; { mocha.run(code =&gt; { var clampedCode = Math.min(code, 255); if (CONF.isRunPassed) clampedCode = 0; fin(clampedCode); }); }; /** * Resets report folder. * * @ignore */ var resetReport = () =&gt; { if (CONF.clearReport &amp;&amp; fs.existsSync(CONF.reportsDir)) { fse.removeSync(CONF.reportsDir); } fse.mkdirsSync(CONF.reportsDir); }; module.exports = run; × Search results Close "},"globals_scope.js.html":{"id":"globals_scope.js.html","title":"Source: globals/scope.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/scope.js /* global describe */ &quot;use strict&quot;; var U = require(&quot;glace-utils&quot;); /** * Execute tests scope. * * @global * @function * @arg {string} name - Scope name. * @arg {object} [opts] - Scope options. * @arg {number} [opts.chunkRetry] - Number of chunk retries on failure. * @arg {number} [opts.chunkTimeout] - Time to execute chunk or hook, sec. * @arg {function[]} [fixtures] - List of fixtures. * @arg {function} func - Function with test cases. * @example scope(&quot;Some test scope&quot;, () =&gt; { test(&quot;Some test name&quot;, () =&gt; { before(() =&gt; { someFunc(); }); chunk(&quot;chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;chunk #2&quot;, () =&gt; { someFunc(); }); }); }); */ var scope = (name, opts, fixtures, func) =&gt; { if (opts instanceof Function) { func = opts; opts = {}; fixtures = []; } if (fixtures instanceof Function) { func = fixtures; fixtures = []; } opts = opts || {}; fixtures = fixtures || {}; describe(name, function () { if (opts.chunkRetry) this.retries(opts.chunkRetry); if (opts.chunkTimeout) this.timeout(opts.chunkTimeout * 1000); U.wrap(fixtures, func)(); }); }; module.exports = scope; × Search results Close "},"globals_session.js.html":{"id":"globals_session.js.html","title":"Source: globals/session.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: globals/session.js /* global scope before */ &quot;use strict&quot;; var U = require(&quot;glace-utils&quot;); var CONF = require(&quot;../config&quot;); /** * Executed sessions counter. * * @type {Number} */ var sessNum = 0; /** * Executes tests session. * * @global * @function * @arg {string} [name] - Session name. By default it includes start date time. * @arg {object} [ctx] - Session context. By default it's empty. * @arg {function} func - Function with test cases. * @example session(() =&gt; { test(&quot;Test #1&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); test(&quot;Test #2&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); }); */ var session = (name, ctx, fixtures, func) =&gt; { if (name instanceof Function) { func = name; name = CONF.sessionName; ctx = {}; fixtures = []; } if (ctx instanceof Function) { func = ctx; ctx = {}; fixtures = []; } if (fixtures instanceof Function) { func = fixtures; fixtures = []; } name = name || CONF.sessionName; ctx = ctx || {}; fixtures = fixtures || []; sessNum++; ctx.sessionNumber = sessNum; scope(name, () =&gt; { before(() =&gt; CONF.isRunPassed = true); U.wrap(fixtures, func)(); }); }; module.exports = session; × Search results Close "},"steps_index.js.html":{"id":"steps_index.js.html","title":"Source: steps/index.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: steps/index.js &quot;use strict&quot;; /** * Creates new instance of `Steps` class. * * @class * @classdesc Contains collection of steps which may be called inside tests via * its instance [SS](global.html#SS). It mixes steps from plugins too. * @name Steps * @mixes TimerSteps * @prop {object} ctx - Storage to share some data between steps. */ var util = require(&quot;util&quot;); require(&quot;colors&quot;); var _ = require(&quot;lodash&quot;); var U = require(&quot;glace-utils&quot;); var CONF = require(&quot;../config&quot;); var plugins = require(&quot;../plugins&quot;); var Steps = function () { this.ctx = {}; }; module.exports = Steps; /** * Helper to reset steps context. * * @method */ Steps.prototype.resetCtx = function () { this.ctx = {}; }; /** * Helper to check whether test was failed before current step. * * @method * @return {undefined|boolean} `undefined` if test is absent, * `true` if test was failed, `false` otherwise. */ Steps.prototype.isTestFailed = function () { if (!CONF.curTestCase) return; return !!CONF.curTestCase.errors.length; }; /** * Step to enter to interactive debugging mode. May be used inside test if you * need to debug test in runtime. * * @async * @method * @return {Promise&lt;void&gt;} * @example * * test(&quot;my test&quot;, () =&gt; { * chunk(async () =&gt; { * await SS.debug(); * }); * }); */ Steps.prototype.debug = async function () { var onFail = CONF.debugOnFail; CONF.debugOnFail = false; await U.debug(); CONF.debugOnFail = onFail; }; /** * Registers steps (mixes them). * * @method * @static * @arg {...object} steps - Sequence of steps to register. * @example * * var MyStepsMixin = require(&quot;./my-steps-mixin&quot;); * var AnotherStepsMixin = require(&quot;./another-steps-mixin&quot;); * * Steps.register(MyStepsMixin, AnotherStepsMixin); */ Steps.register = function () { for (var obj of arguments) { _.assign(this.prototype, obj); } }; /** * Helper to get steps instance. * * It wraps steps class with proxy object. Proxy observes steps call and in * debug mode if steps is failed it entered test to interactive debug mode. * * @method * @static * @arg {function} [cls] - Class with steps. By default original glace `Steps` * will be used. * @return {Proxy} Wrapped steps instance. */ Steps.getInstance = function (cls) { return new Proxy( new (cls || Steps), { get: (target, property) =&gt; { var func = target[property]; if (!util.isFunction(func)) return func; if (property === &quot;debug&quot; || !CONF.debugOnFail) { return func.bind(target); } return async function () { try { var result = await func.apply(target, arguments); } catch (e) { console.log(e.toString().red); await target.debug(); throw e; } return result; }; }, }); }; Steps.register(require(&quot;./timer&quot;)); /* Load plugins steps */ Steps.register.apply(Steps, plugins.getModules(&quot;Steps&quot;)); × Search results Close "},"steps_timer.js.html":{"id":"steps_timer.js.html","title":"Source: steps/timer.js","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Source: steps/timer.js /* global expect */ &quot;use strict&quot;; /** * Steps to measure time. * * These methods will be mixed with glacejs [Steps](https://glacejs.github.io/glace-core/Steps.html) * class and available via its instance [SS](https://glacejs.github.io/glace-core/global.html#SS) * in tests. * * @mixin TimerSteps */ var U = require(&quot;glace-utils&quot;); var LOG = U.logger; var TimerSteps = { /** * Step to make pause in another step or test case. **Good style** is * to not use directly in test case, only inside another step. * * @async * @method * @instance * @arg {number} timeout - Pause time, sec. * @arg {string} message - Pause reason. * @return {Promise&lt;void&gt;} * @throws {AssertionError} If pause message isn't defined. * @example * * await SS.pause(1, &quot;wait for server start&quot;); */ pause: async function (timeout, message) { expect(message, &quot;Pause message is not defined&quot;).to.not.be.undefined; LOG.warn(&quot;Sleep&quot;, timeout, &quot;sec, reason:&quot;, message); await U.sleep(timeout * 1000); }, /** * Step to start timer. * Each time when it will be called, timer will be reset. * * @method * @instance * @example * * SS.startTimer(); * await SS.pause(1, &quot;sleep a bit&quot;); * var elapsedSeconds = SS.getTimer(); */ startTimer: function () { this._timer = new Date(); }, /** * Step to stop timer. * * @method * @instance * @example * * SS.stopTimer(); */ stopTimer: function () { this._timer = null; }, /** * Step to get timer. * * @method * @instance * @return {number} Number of seconds since timer starts. * @throws {AssertionError} If timer isn't started. * @example * * SS.startTimer(); * await SS.pause(1, &quot;sleep a bit&quot;); * var elapsedSeconds = SS.getTimer(); */ getTimer: function () { expect(this._timer, &quot;Timer isn't started&quot;).to.exist; return (new Date() - this._timer) / 1000; }, /** * Step to check timer. * * @method * @instance * @arg {string|object} condition - [chaijs](http://chaijs.com/) condition. * @throws {AssertionError} If timer verification was failed. * @example * * SS.startTimer(); * SS.checkTimer(&quot;to exist&quot;); * * SS.startTimer(); * await SS.pause(1, &quot;sleep a bit&quot;); * SS.checkTimer({ &quot;to be gte&quot;: 1 }); */ checkTimer: function (condition) { expect(this.getTimer(), &quot;Timing is failed&quot;).to.correspond(condition); }, }; module.exports = TimerSteps; × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Global Members CONF GlaceJS config. Source: globals/index.js, line 53 See: config to get more details about its options. reporters :Array.&lt;object&gt; Registered reporters. Type: Array.&lt;object&gt; Source: reporter/base.js, line 24 sessNum :Number Executed sessions counter. Type: Number Source: globals/session.js, line 14 sinon SinonJS is pretty nice lib for mocking. Source: globals/index.js, line 43 SS :Steps Atomic steps collection. Type: Steps Source: globals/index.js, line 61 See: steps to get more details about its methods. Methods afterChunk(name, func) Executes after each test chunk. Parameters: Name Type Description name string Name of test case. func function Hook function. Source: globals/index.js, line 114 Example test(&quot;Some test&quot;, () =&gt; { afterChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); &lt;abstract&gt; baseTest(name [, opts] [, fixtures], func) Basis for any test case. If test with the same was registered already, this test will be omitted with corresponding error in log. If retries amount is specified and this test was failed, the test will be added to queue in separated session with title containing Retry and its number. Parameters: Name Type Argument Description name string Name of test case. opts object &lt;optional&gt; Options. Properties Name Type Argument Default Description skip boolean &lt;optional&gt; false Flag to skip test. skipReason string &lt;optional&gt; null Skip reason if test is marked as skipped. retry number &lt;optional&gt; 0 Number of retries on failure. Overrides config value for concrete test. chunkRetry number &lt;optional&gt; 0 Number of chunk retries on failure. Overrides config value for concrete test chunks. chunkTimeout number &lt;optional&gt; &lt;nullable&gt; null Time to execute chunk or hook, sec. fixtures Array.&lt;function()&gt; &lt;optional&gt; Involved fixtures list. func function Test function. Source: globals/test.js, line 51 beforeChunk(name, func) Executes before each test chunk. Parameters: Name Type Description name string Name of test case. func function Hook function. Source: globals/index.js, line 91 Example test(&quot;Some test&quot;, () =&gt; { beforeChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); chunk( [name] [, opts], func) Defines test chunk. Contains actions and verifications, which will be executed separatly from another chunks. This function is used to organize test structure and to allocate independent test actions. Parameters: Name Type Argument Description name string &lt;optional&gt; Name of chunk. opts object &lt;optional&gt; Chunk options. Properties Name Type Argument Description retry number &lt;optional&gt; Number of chunk retries on failure. timeout number &lt;optional&gt; Time limit to execute chunk, sec. func function Callback function with test payload. Source: globals/chunk.js, line 49 Examples Anonymous chunk test(&quot;My test&quot;, () =&gt; { chunk(() =&gt; { var a = 5; expect(a).to.be.equal(2); }); }); Named chunk test(&quot;My test&quot;, () =&gt; { chunk(&quot;My chunk&quot;, () =&gt; { var a = 5; expect(a).to.be.equal(2); }); }); Chunk with options test(&quot;My test&quot;, () =&gt; { chunk(&quot;My chunk&quot;, { retry: 2, timeout: 1 }, () =&gt; { var a = 5; expect(a).to.be.equal(2); }); }); expect(actualValue) chaijs expect function. Parameters: Name Type Description actualValue * Some actual value which should be checked. Source: globals/index.js, line 37 See: chaijs to get more details about `expect` usage. Example expect(1).to.be.equal(1); expect(2).to.be.gte(0); forEachLanguage( [ctx] [, opts] [, fixtures], func) Iterates test chunks through all languages specified in config or options. It's applicable for multilingual application. If list of languages is specified, it will be used firstly. Otherwise from configuration. Parameters: Name Type Argument Description ctx object &lt;optional&gt; Test case context. opts object &lt;optional&gt; Options. Properties Name Type Argument Description languages Array.&lt;string&gt; &lt;optional&gt; &lt;nullable&gt; List of tested languages. fixtures Array.&lt;function()&gt; &lt;optional&gt; Involved fixtures list. func function Function with test steps. Source: globals/forEachLanguage.js, line 32 Example test(&quot;Some test&quot;, ctx =&gt; { forEachLanguage(ctx, lang =&gt; { chunk(() =&gt; { // payload }); }); }); help(d, cb) Help description. Parameters: Name Type Description d function Function to process option description. cb function Callback to expand default help. Source: help.js, line 2 rewire() rewire is great lib for monkey patching, but it should be a bit patched too :) Source: globals/rewire.js, line 11 run(cb) Runs tests. executes runner.js file, which is entry point to load and execute files with tests connects custom reporter to mochajs. Parameters: Name Type Description cb function Callback. Source: run.js, line 2 scope(name [, opts] [, fixtures], func) Execute tests scope. Parameters: Name Type Argument Description name string Scope name. opts object &lt;optional&gt; Scope options. Properties Name Type Argument Description chunkRetry number &lt;optional&gt; Number of chunk retries on failure. chunkTimeout number &lt;optional&gt; Time to execute chunk or hook, sec. fixtures Array.&lt;function()&gt; &lt;optional&gt; List of fixtures. func function Function with test cases. Source: globals/scope.js, line 35 Example scope(&quot;Some test scope&quot;, () =&gt; { test(&quot;Some test name&quot;, () =&gt; { before(() =&gt; { someFunc(); }); chunk(&quot;chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;chunk #2&quot;, () =&gt; { someFunc(); }); }); }); session( [name] [, ctx], func) Executes tests session. Parameters: Name Type Argument Description name string &lt;optional&gt; Session name. By default it includes start date time. ctx object &lt;optional&gt; Session context. By default it's empty. func function Function with test cases. Source: globals/session.js, line 45 Example session(() =&gt; { test(&quot;Test #1&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); test(&quot;Test #2&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); }); setLog() Helper to set actual log file. Source: globals/test.js, line 20 test(name [, opts] [, fixtures], func) Executes test case. Parameters: Name Type Argument Description name string Name of test case. opts object &lt;optional&gt; Options. Properties Name Type Argument Default Description skip boolean &lt;optional&gt; false Flag to skip test. skipReason string &lt;optional&gt; null Skip reason if test is marked as skipped. retry number &lt;optional&gt; 0 Number of retries on failure. Overrides config value for concrete test. chunkRetry number &lt;optional&gt; 0 Number of chunk retries on failure. Overrides config value for concrete test chunks. chunkTimeout number &lt;optional&gt; &lt;nullable&gt; null Time to execute chunk or hook, sec. fixtures Array.&lt;function()&gt; &lt;optional&gt; Involved fixtures list. func function Test function. Source: globals/test.js, line 162 Example test(&quot;Some test&quot;, () =&gt; { chunk(&quot;Some chunk&quot;, () =&gt; { someFunc(); }); }); × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Modules Classes GlaceReporter ConfigError StepError TestCase Steps Mixins TimerSteps Namespaces GlaceConfig × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Classes Classes GlaceReporter ConfigError StepError TestCase Steps Mixins TimerSteps Namespaces GlaceConfig × Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Namespaces Classes GlaceReporter ConfigError StepError TestCase Steps Mixins TimerSteps Namespaces GlaceConfig × Search results Close "},"mixins.list.html":{"id":"mixins.list.html","title":"Mixins","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Mixins Classes GlaceReporter ConfigError StepError TestCase Steps Mixins TimerSteps Namespaces GlaceConfig × Search results Close "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Tutorials Classes GlaceReporter ConfigError StepError TestCase Steps Mixins TimerSteps Namespaces GlaceConfig × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest | Source Code | Release Notes Glace (fr. glacé — ice, frozen) is a cold drink based on coffee with addition of ice cream. AnnotationGlaceJS is a quick-start functional testing framework based on mocha and extensible with plugins. Why it is Firstly it's R&amp;D project for me to dive deeply to programming and software architecture. Current testing frameworks like mocha or jasmine look cool for unit testing but are not flexible for complex functional scenarios. Features Cross-platform Based on STEPS-architecture and STEPS-protocol May be extended with plugins implemented STEPS-protocol Oriented to complex functional scenarios Indepentently executed chunks inside a test Parameterization inside and outside of test Mechanism to retry failed tests Mechanism to retry failed chunks Mechanism to process uncaught exceptions (mocha mechanism is unreliable but supported) Fixtures support similar to pytest fixtures Conftest and preloads support Test &amp; chunk options Multiple reporting system Stdout reporter in-box TestRail reporter in-box Easy to provide custom reporter May read CLI arguments from JSON file May be extended with custom JavaScript config May be used as platform for own testing frameworks development How to installnpm i glace-coreFor development: git clone https://github.com/glacejs/glace-core cd glace-core npm i gulp test-unit // launch unit tests gulp test-all // launch all integration tests gulp --tasks // show all tasksHow to useglace [options] [sequence-of-test-files-or-folders]How glace loads tests ➤ CLI optionsCommon --version - Show version number. -h, --help - Show help. Arguments --config [path], -c - Path to JSON file with CLI arguments. Default is cwd/config.json (if it exists). Note! All options below may be set via .json file (see option --config above). Log --stdout-log - Print log messages to stdout. --log [path] - Path to log file. Default is cwd/glace.log. --log-level [level] - Log level. Default is debug. Core --user-config [path] - Path to JS file with configuration which will be merged with override default configuration. Default is cwd/config.js (if it exists). --session-name [name] - Tests run session name. Default value includes word session and datetime. --grep &lt;pattern&gt;, -g - Filter tests by name or name chunk. --report [path] - Path to reports folder. Default is cwd/reports. --dont-clear-report - Don't clear previous report on tests run. --root-conftest &lt;path&gt; - Path to root conftest.js which will be loaded before all. --languages &lt;sequence&gt; - List of tested languages separated with comma. --retry [times] - Number of times to retry failed test. Default is 0. --chunk-retry [times] - Number of times to retry failed chunk. Default is 0. --chunk-timeout [sec] - Time to execute chunk or hook, sec. Default is 180. --uncaught [type] - Strategy to process uncaught exceptions. Default value is log. Supported values are log just to log uncaught exceptions, fail to fail test if uncaught exception happened, mocha to use default mocha mechanism (unreliable). --kill-procs &lt;sequence&gt; - List of process names separated with comma, which will be killed before tests run. --debug-on-fail - Enter to interactive debug mode on step failure. Plugins --plugins - Show plugins only. --plugins-dir [path] - Path to custom plugins folder. By default it searches plugins inside folder, where glace-core is installed. --disable-default-plugins - Disable default plugins. xUnit --xunit - Activate xUnit reporter. --xunit-path [path] - Path to xUnit report. Default is cwd/xunit.xml. --xunit-suite-name [name] - Tests suite name in xUnit report. By default it's the same as session name. TestRail --testrail - Activate testrail reporter. --testrail-host &lt;host&gt; - TestRail host. --testrail-user &lt;user&gt; - TestRail username or email. --testrail-token &lt;token&gt; - TestRail token. --testrail-project-id &lt;id&gt; - TestRail project id. --testrail-suite-id &lt;id&gt; - TestRail suite id. --testrail-run-name &lt;name&gt; - TestRail run name. --testrail-run-desc &lt;description&gt; - TestRail run description. Quick start Make sure that you have installed glace-core Create file my-test.js with next content: &quot;use strict&quot;; test(&quot;#1&quot;, () =&gt; { chunk(() =&gt; { console.log(&quot;hello world&quot;); }); }); test(&quot;#2&quot;, () =&gt; { chunk(() =&gt; { throw new Error(&quot;BOOM!&quot;); }); }); Launch terminal, navigate to folder with file my-test.js and execute command: glace my-test.js After that tests will be executed. In current work directory create file config.json with next content: { &quot;grep&quot;: &quot;#1&quot;, &quot;xunit&quot;: true } Launch glace again: glace my-test.js glace CLI options will be read from config.json. It is a good style to use only Steps inside chunks via its global instance SS and follow to STEPS methodology. test(&quot;my test&quot;, () =&gt; { chunk(async () =&gt; { await SS.pause(1, &quot;sleep a bit&quot;); }); }); Test examplesSee integration tests in order to explore examples. Frameworks platformGlaceJS may be used as platform for own testing frameworks development. Simple example: require(&quot;colors&quot;); require(&quot;glace-core&quot;).run().then(errCode =&gt; { if (!errCode) { console.log(&quot;It's passed! 🙂&quot;.green.bold); } else { console.log(&quot;It's failed! 🙁&quot;.red.bold); }; process.exit(errCode); });GuidelinesHow to retry tests or chunksIn order to retry failed tests or chunks you may pass CLI options --retry or --chunk-retry to affect all tests or chunks or to specify retry option for concrete test or chunk. How to use fixturesIn order to avoid copy/paste with before and after hooks in tests you may use fixtures... Read more ➤ × Search results Close "},"GlaceConfig.html":{"id":"GlaceConfig.html","title":"Namespace: GlaceConfig","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Namespace: GlaceConfig GlaceConfig Configures GlaceJS before tests run. Properties: Name Type Argument Default Description curTestCase TestCase &lt;nullable&gt; Currently executed test. testCases Array.&lt;TestCase&gt; List of executed tests. preloads Array.&lt;string&gt; List of module paths which will be loaded before test run. testDirs Array.&lt;string&gt; &lt;optional&gt; cwd/tests List of folder or file paths with tests. reportsDir string &lt;optional&gt; cwd/reports Path to reports folder. logsDir string &lt;optional&gt; reportsDir Path to logs folder. debugOnFail boolean &lt;optional&gt; false Flag to enter to debug mode on test failure. isRunPassed boolean &lt;optional&gt; &lt;nullable&gt; Whether test run is passed. languages Array.&lt;string&gt; &lt;optional&gt; [] List of tested languages. clearReport boolean &lt;optional&gt; true Clear report before test run. uncaught string &lt;optional&gt; log Strategy to process uncaught exceptions. rootConftest string &lt;optional&gt; Path to root conftest.js. testRetries number &lt;optional&gt; 0 Number of test retries on test failure. chunkRetries number &lt;optional&gt; 0 Number of chunk retries on chunk failure. grep string Test name or name chunk to filter tests. pluginsDir string Path to custom plugins folder. sessionName string &lt;optional&gt; Name of tests session. sessionId number &lt;optional&gt; ID of tests session. killProcs Array.&lt;string&gt; &lt;optional&gt; &lt;nullable&gt; List of process names which will be killed before tests run. testrail object TestRail reporter configuration. Properties Name Type Argument Default Description use boolean &lt;optional&gt; false Activate TestRail reporter. host string &lt;optional&gt; &lt;nullable&gt; null TestRail host. user string &lt;optional&gt; &lt;nullable&gt; null TestRail user. token string &lt;optional&gt; &lt;nullable&gt; null TestRail token. projectId number &lt;optional&gt; &lt;nullable&gt; null TestRail project ID. suiteId number &lt;optional&gt; &lt;nullable&gt; null TestRail suite ID. runName string &lt;optional&gt; &lt;nullable&gt; null TestRail run name. runDescription string &lt;optional&gt; &lt;nullable&gt; null TestRail run description. Source: config.js, line 2 × Search results Close "},"GlaceReporter.html":{"id":"GlaceReporter.html","title":"Class: GlaceReporter","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Class: GlaceReporter GlaceReporter new GlaceReporter(runner) GlaceJS common reporter. Parameters: Name Type Description runner object MochaJS runner. Source: reporter/base.js, line 2 Methods &lt;static&gt; register(reporters) Registers reporters if they are not. Parameters: Name Type Argument Description reporters object &lt;repeatable&gt; Sequence of reporters to register. Source: reporter/base.js, line 155 &lt;static&gt; remove(reporters) Removes reporters if they are registered. Parameters: Name Type Argument Description reporters object &lt;repeatable&gt; Sequence of reporters to remove. Source: reporter/base.js, line 169 &lt;async&gt; done(failures, fn) Finalizes reporting. Parameters: Name Type Description failures Array.&lt;*&gt; Tests failures. fn function Finalizator. Source: reporter/base.js, line 137 × Search results Close "},"module-cli.html":{"id":"module-cli.html","title":"Module: cli","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: cli Contains functions to execute tests via command line interface. Source: cli.js, line 2 Methods &lt;static&gt; run() Runs GlaceJS in CLI. Source: cli.js, line 16 × Search results Close "},"module-error.html":{"id":"module-error.html","title":"Module: error","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: error Contains GlaceJS errors. Source: error.js, line 2 Classes ConfigError StepError × Search results Close "},"module-error-ConfigError.html":{"id":"module-error-ConfigError.html","title":"Class: ConfigError","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Class: ConfigError error~ ConfigError new ConfigError(message) Error which is thrown when configuration is wrong. Parameters: Name Type Description message string Error message. Source: error.js, line 16 × Search results Close "},"module-error-StepError.html":{"id":"module-error-StepError.html","title":"Class: StepError","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Class: StepError error~ StepError new StepError(message) Error which is thrown when step execution is wrong. Parameters: Name Type Description message string Error message. Source: error.js, line 26 × Search results Close "},"module-globals_index.html":{"id":"module-globals_index.html","title":"Module: globals/index","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: globals/index Contains global framework functions and helpers. Source: globals/index.js, line 5 × Search results Close "},"module-hacking.html":{"id":"module-hacking.html","title":"Module: hacking","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: hacking Contains hacks for test run. Source: hacking.js, line 2 Members &lt;inner&gt; _mochaRunner :Runner Mocha runner. Type: Runner Source: hacking.js, line 46 Methods &lt;static&gt; getRunner() Gets mocha runner. Source: hacking.js, line 58 &lt;static&gt; suppressMochaUncaught() Patches original Mocha.Runner.prototype.uncaught in order to skip exceptions from proxy server res.send(). Source: hacking.js, line 19 × Search results Close "},"module-index.html":{"id":"module-index.html","title":"Module: index","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: index GlaceJS main module. Properties: Name Type Description config object Config module. error object Error module. help function Help module. reporter object Reporter module. run object run module. Steps object Steps module. Source: index.js, line 2 Members &lt;inner&gt; config :GlaceConfig Type: GlaceConfig Source: index.js, line 21 &lt;inner&gt; help Help. Source: index.js, line 36 &lt;inner&gt; reporter :GlaceReporter Type: GlaceReporter Source: index.js, line 51 &lt;inner&gt; run :run Type: run Source: index.js, line 60 &lt;inner&gt; Steps :Steps Type: Steps Source: index.js, line 69 × Search results Close "},"module-loader.html":{"id":"module-loader.html","title":"Module: loader","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: loader Makes tests root session. runner loads root conftest.js if it is located on one level with each of CONF.testDirs; if each of CONF.testDirs is file with tests, runner loads and executes it; if each of CONF.testDirs is folder runner loads files inside recursive if file name starts with test and ends with .js; inside each subfolder of each of CONF.testDirs runner loads conftest.js file if it is present; Source: loader.js, line 5 Methods &lt;inner&gt; loadTests(dir) Loads test files recursively. Test file name should start with test and end with .js. Parameters: Name Type Description dir string Folder with test files. Source: loader.js, line 110 &lt;inner&gt; mainConftests() Main conftests are loaded before tests session creation and may used for objects management, for example to created custom instance of global SS. Main conftest is conftest.js file which is located on one hierarchy level with each specified tests folder or file. Source: loader.js, line 63 &lt;inner&gt; preloads() Loads special preloads files before main conftests and test files. Preloads are specified in CONF.preloads array. It may be managed only programmatically and needs as extension point to load some custom files before tests. After preloads it loads root (the mainest) conftest file, which may be set via CLI. Source: loader.js, line 40 &lt;inner&gt; sessFunc() Callback to create tests session. It kills some processes before all if they are specified. Source: loader.js, line 84 × Search results Close "},"module-matcher.html":{"id":"module-matcher.html","title":"Module: matcher","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: matcher Matchers. Source: matcher.js, line 2 × Search results Close "},"module-plugins.html":{"id":"module-plugins.html","title":"Module: plugins","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: plugins Plugins. Source: plugins.js, line 2 Methods &lt;static&gt; clearCache() Clear plugins cache. Source: plugins.js, line 103 &lt;static&gt; getModules(moduleName) Gets modules from plugins. Parameters: Name Type Description moduleName string Name of module to request from plugins. Source: plugins.js, line 26 Returns: List of modules requested from plugins. Type Array.&lt;object&gt; &lt;static&gt; register(name) Register custom plugin. Parameters: Name Type Description name string Name of plugin module. Source: plugins.js, line 110 × Search results Close "},"module-reporter_index.html":{"id":"module-reporter_index.html","title":"Module: reporter/index","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: reporter/index GlaceJS reporter package. Source: reporter/index.js, line 2 × Search results Close "},"module-reporter_stdout.html":{"id":"module-reporter_stdout.html","title":"Module: reporter/stdout","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: reporter/stdout GlaceJS stdout reporter. Source: reporter/stdout.js, line 2 Methods done() Called on report finalizing. Source: reporter/stdout.js, line 221 end() Called before tests end. Source: reporter/stdout.js, line 123 fail(chunk) Called on chunk or hook failed. Parameters: Name Type Description chunk object MochaJS test. Source: reporter/stdout.js, line 195 pass(chunk) Called on chunk passed. Parameters: Name Type Description chunk object MochaJS test. Source: reporter/stdout.js, line 183 scope(scope) Called on scope start. Parameters: Name Type Description scope object MochaJS suite. Source: reporter/stdout.js, line 137 scopeEnd() Called before scope end. Source: reporter/stdout.js, line 150 test(test) Called on test start. Parameters: Name Type Description test object MochaJS suite. Source: reporter/stdout.js, line 161 testEnd() Called on test end. Source: reporter/stdout.js, line 172 × Search results Close "},"module-reporter_testrail.html":{"id":"module-reporter_testrail.html","title":"Module: reporter/testrail","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: reporter/testrail TestRail reporter. Source: reporter/testrail.js, line 2 Methods done() Called on report finalizing. Source: reporter/testrail.js, line 163 end() Called before tests end. Source: reporter/testrail.js, line 89 start() Called on tests start. Source: reporter/testrail.js, line 43 testEnd(test) Called on test end. Parameters: Name Type Description test object MochaJS suite. Source: reporter/testrail.js, line 104 × Search results Close "},"module-reporter_xunit.html":{"id":"module-reporter_xunit.html","title":"Module: reporter/xunit","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: reporter/xunit GlaceJS xunit reporter. Source: reporter/xunit.js, line 2 Methods &lt;inner&gt; write(line) Writes a line. Parameters: Name Type Description line string Report text line. Source: reporter/xunit.js, line 58 &lt;inner&gt; writeTest(test) Writes a test. Parameters: Name Type Description test TestCase Test case. Source: reporter/xunit.js, line 66 × Search results Close "},"module-testing.html":{"id":"module-testing.html","title":"Module: testing","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Module: testing Contains classes and functions to save executed tests data. Source: testing.js, line 2 Classes TestCase × Search results Close "},"module-testing-TestCase.html":{"id":"module-testing-TestCase.html","title":"Class: TestCase","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Class: TestCase testing~ TestCase new TestCase(name) Test case data structure. Contains full information and history about test case. Parameters: Name Type Description name string Test name. Properties: Name Type Argument Default Description name string Test name. status status &lt;optional&gt; NOT_STARTED Test status. screenshots Array.&lt;string&gt; &lt;optional&gt; [] List of test screenshot paths. videos Array.&lt;string&gt; &lt;optional&gt; [] List of test video paths. errors Array.&lt;string&gt; &lt;optional&gt; [] List of test errors. rawInfo Array.&lt;string&gt; &lt;optional&gt; [] List of additional test details. failedParams Array.&lt;object&gt; &lt;optional&gt; [] List of test failed parameters. testParams object &lt;optional&gt; {} Dict of test parameters. Source: testing.js, line 26 Methods addChunk(chunkName) Adds chunk. Parameters: Name Type Description chunkName string Name of chunk. Source: testing.js, line 126 addDetails(info) Adds additional information. Parameters: Name Type Description info string Additional information. Source: testing.js, line 117 addError(err) Adds error to test case. Parameters: Name Type Description err Error Test error. Source: testing.js, line 90 addFailedParams(params) Adds failed params if they don't exist. Parameters: Name Type Description params object Parameters which test was failed with. Source: testing.js, line 78 addScreenshot(imagePath) Adds screenshot. Parameters: Name Type Description imagePath string Path to saved screenshot. Source: testing.js, line 99 addVideo(videoPath) Adds video. Parameters: Name Type Description videoPath string Path to saved video. Source: testing.js, line 108 end(status) Ends test case. Parameters: Name Type Description status string Test case status. Source: testing.js, line 51 reset() Resets test case info. Source: testing.js, line 64 start() Starts test case. Source: testing.js, line 38 × Search results Close "},"Steps.html":{"id":"Steps.html","title":"Class: Steps","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Class: Steps Steps Contains collection of steps which may be called inside tests via its instance SS. It mixes steps from plugins too. new Steps() Creates new instance of Steps class. Properties: Name Type Description ctx object Storage to share some data between steps. Mixes In: TimerSteps Source: steps/index.js, line 2 Methods &lt;static&gt; getInstance( [cls]) Helper to get steps instance. It wraps steps class with proxy object. Proxy observes steps call and in debug mode if steps is failed it entered test to interactive debug mode. Parameters: Name Type Argument Description cls function &lt;optional&gt; Class with steps. By default original glace Steps will be used. Source: steps/index.js, line 97 Returns: Wrapped steps instance. Type Proxy &lt;static&gt; register(steps) Registers steps (mixes them). Parameters: Name Type Argument Description steps object &lt;repeatable&gt; Sequence of steps to register. Source: steps/index.js, line 79 Example var MyStepsMixin = require(&quot;./my-steps-mixin&quot;); var AnotherStepsMixin = require(&quot;./another-steps-mixin&quot;); Steps.register(MyStepsMixin, AnotherStepsMixin); &lt;async&gt; debug() Step to enter to interactive debugging mode. May be used inside test if you need to debug test in runtime. Source: steps/index.js, line 60 Returns: Type Promise.&lt;void&gt; Example test(&quot;my test&quot;, () =&gt; { chunk(async () =&gt; { await SS.debug(); }); }); isTestFailed() Helper to check whether test was failed before current step. Source: steps/index.js, line 41 Returns: undefined if test is absent, true if test was failed, false otherwise. Type undefined | boolean resetCtx() Helper to reset steps context. Source: steps/index.js, line 31 × Search results Close "},"TimerSteps.html":{"id":"TimerSteps.html","title":"Mixin: TimerSteps","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Mixin: TimerSteps TimerSteps Steps to measure time. These methods will be mixed with glacejs Steps class and available via its instance SS in tests. Source: steps/timer.js, line 5 Methods checkTimer(condition) Step to check timer. Parameters: Name Type Description condition string | object chaijs condition. Source: steps/timer.js, line 99 Throws: If timer verification was failed. Type AssertionError Example SS.startTimer(); SS.checkTimer(&quot;to exist&quot;); SS.startTimer(); await SS.pause(1, &quot;sleep a bit&quot;); SS.checkTimer({ &quot;to be gte&quot;: 1 }); getTimer() Step to get timer. Source: steps/timer.js, line 79 Throws: If timer isn't started. Type AssertionError Returns: Number of seconds since timer starts. Type number Example SS.startTimer(); await SS.pause(1, &quot;sleep a bit&quot;); var elapsedSeconds = SS.getTimer(); &lt;async&gt; pause(timeout, message) Step to make pause in another step or test case. Good style is to not use directly in test case, only inside another step. Parameters: Name Type Description timeout number Pause time, sec. message string Pause reason. Source: steps/timer.js, line 34 Throws: If pause message isn't defined. Type AssertionError Returns: Type Promise.&lt;void&gt; Example await SS.pause(1, &quot;wait for server start&quot;); startTimer() Step to start timer. Each time when it will be called, timer will be reset. Source: steps/timer.js, line 51 Example SS.startTimer(); await SS.pause(1, &quot;sleep a bit&quot;); var elapsedSeconds = SS.getTimer(); stopTimer() Step to stop timer. Source: steps/timer.js, line 63 Example SS.stopTimer(); × Search results Close "},"tutorial-concepts.html":{"id":"tutorial-concepts.html","title":"Tutorial: GlaceJS concepts","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest GlaceJS concepts test - test case. Wrapper on mochajs describe. Should have readable and unique name per suite. test(&quot;my test&quot;, () =&gt; { chunk(() =&gt; { // payload }); });chunk - a set of actions in test. Wrapper on mochajs it. Test should contain as minimum one chunk. Chunks are executed independently inside a test. Chunk may have name or be anonymous. /* anonymous chunk */ test(&quot;my test&quot;, () =&gt; { chunk(() =&gt; { // payload }); }); /* named chunks */ test(&quot;my test&quot;, () =&gt; { chunk(&quot;#1&quot;, () =&gt; { // payload }); chunk(&quot;#2&quot;, () =&gt; { // payload }); });scope - the scope of tests or chunks, which is used for grouping. Wrapper on mochajs describe. If you have more than one file with tests, it will be a good style to wrap all tests inside file under one scope for visual grouping in stdout report. /* scope of tests */ scope(&quot;Auth&quot;, () =&gt; { test(&quot;is passed&quot;, () =&gt; { // test case }); test(&quot;is failed&quot;, () =&gt; { // test case }); }); /* scope of chunks */ test(&quot;Auth&quot;, () =&gt; { scope(&quot;is passed&quot;, () =&gt; { chunk(&quot;for user&quot;, () =&gt; { // payload }); chunk(&quot;for admin&quot;, () =&gt; { // payload }); }); });before - mochajs before. after - mochajs after. beforeChunk - wrapper on mochajs beforeEach. afterChunk - wrapper on mochajs afterEach. × Search results Close "},"tutorial-mocha-uncaught.html":{"id":"tutorial-mocha-uncaught.html","title":"Tutorial: Mocha broken queue with uncaught exceptions","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Mocha broken queue with uncaught exceptions In mocha it's very easy to break async tests queue due to uncaught exceptions processing mechanism in mocha. Create tests file with next content: &quot;use strict&quot;; var sleep = timeout =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { console.log(`I was sleeping ${timeout} ms`); resolve(); }, timeout); }); }; var error = timeout =&gt; { setTimeout(() =&gt; { throw new Error(&quot;BOOM!!!&quot;); }, timeout); }; describe(&quot;scope&quot;, () =&gt; { it (&quot;test #1&quot;, async () =&gt; { error(1000); await sleep(1000); }); it (&quot;test #2&quot;, async () =&gt; await sleep(1000)); it (&quot;test #3&quot;, async () =&gt; { error(1000); await sleep(1000); }); it (&quot;test #4&quot;, async () =&gt; await sleep(1000)); it (&quot;test #5&quot;, async () =&gt; await sleep(1000)); it (&quot;test #6&quot;, async () =&gt; await sleep(1000)); }); Run and get something at first sight incomprehensible: $ mocha uncaught.js scope 1) test #1 # in console it colored as red (failed) I was sleeping 1000 ms √ test #1 (1012ms) 2) test #3 # in console it colored as red (failed) I was sleeping 1000 ms I was sleeping 1000 ms √ test #4 √ test #4 I was sleeping 1000 ms I was sleeping 1000 ms I was sleeping 1000 ms √ test #6 (1002ms) √ test #6 (1002ms) √ test #6 (1003ms) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (uncaught.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (uncaught.js:12:15) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (uncaught.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (uncaught.js:12:15) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (uncaught.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (uncaught.js:12:15At first, please note that test #1 is marked twice: as passed and as failed! Second, test #2 and test #5 are absent in the report. Third, begins simultaneous delivery of messages I was sleeping 1000 ms, first 1 time, then 2 times, then 3 times. Now consider why this is so. The problem is that mocha default handles uncaught exceptions. If such an exception occurs, mocha fails current test, no matter whether with him or even uncaught exception was generated by an asynchronous call to a lot of tests ago (e.g. due to forgotten / hanging timers, etc.). And since this processor is implemented via a listener, then in my example it is a very interesting thing: On one hand in the test after 1 second uncaught exception happens and invokes its handler, on the other side the test explicitly waits for 1 second end of sleep and marks the test as passed. Because of the async of JavaScript, we have two concurrent test processors, which leads to twice appearance of a report of test #1. Moreover, from now on, we have two places which emit event to start a new test. And in fact, one queue was splitted to 2 queues! In test #3 the situation is repeated, leading to further division of the queue. And we have 3 competitive operating test queues! This can be observed by the increment of the number of messages I was sleeping 1000 ms. In our work, we periodically met such split of queue, so this example is based on a real existing problem. In the end, the whole run was in the trash, because due to queue splitting test results weren't correct. How to fixSimple and working variant to suppress uncaught exception. var Mocha = require(&quot;mocha&quot;); Mocha.Runner.prototype.uncaught = function (err) { logger.error(&quot;UNCAUGHT ERROR&quot;, err); };Better to get one failed test, and in finalizers to close all descriptors, proxies, to kill processes, etc., to suppress and log uncaught exception, and then analyze the logs for their presence. Than to collapse the queue and get failed report of all night run. In my work this approach was really helpful. That's why glace supports own variants to process uncaught exceptions (see CLI option --uncaught). P. S. mocha has the option --allow-enable - uncaught uncaught errors to propagate. But I did not understand what it is, because it certainly does not solve the problem. × Search results Close "},"tutorial-parameterization.html":{"id":"tutorial-parameterization.html","title":"Tutorial: Tests parameterization","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Tests parameterization × Search results Close "},"tutorial-release-notes.html":{"id":"tutorial-release-notes.html","title":"Tutorial: Release Notes","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Release Notes v1.2.6 Decomposed global functions. Added option to enter to interactive debug mode on step failure. v1.2.5 Fixed bug that option --chunk-timeout no leaded to default timeout 2000. v1.2.4 Added custom path for log files. v1.2.3 Fixed bug that relative root conftest wasn't resolved correct. v1.2.2 Fixed a bug that glace raised error if steps property didn't exist. v1.2.1 Added helpers for easy integration with glace-testgen plugin. v1.2.0 Added feature to kill processes before tests run. v1.1.9 Fixed bug that on parametrized test failure failed params may be added to retry more that one time. v1.1.8 Added step to enter to interactive debug mode. v1.1.7 Patched rewire in order to add method __reset__ to restore original module state. v1.1.6 Added rewire and sinon-chai. v1.1.5 Fixed bug that matcher waitFor didn't work correct with async predicates. v1.1.4 Added chai matcher waitFor. v1.1.3 Expanded test &amp; chunk options. v1.1.2 Updated mocha to latest version. Updated glace-utils to support config parents loading. v1.1.1 Fixed typo in tests loader method to scan test modules. Added feature to show tests summary time. Added feature to capture skipped tests in reporters. Fixed bug with disorder in plugins loader. v1.1.0 Generate session ID on start. v1.0.9 Show a number of executed chunks in report. Show link to xunit report if it is active. v1.0.8 Supports xunit reporter, which may be activated with CLI option --xunit. v1.0.7 Plugin reporters are registered on reporting system loading. CLI option --chunk timeout &lt;timeout&gt; sets time (sec) to execute for all hooks and chunks. Default value is 180 sec. Test or scope option { chunkTimeout: &lt;timeout&gt; } sets time (sec) to execute for hooks and chunks inside test or scope and overrides global value. × Search results Close "},"tutorial-reports.html":{"id":"tutorial-reports.html","title":"Tutorial: Test reports","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Test reports × Search results Close "},"tutorial-retry.html":{"id":"tutorial-retry.html","title":"Tutorial: Tests and chunks retry","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Tests and chunks retry × Search results Close "},"tutorial-steps-architecture.html":{"id":"tutorial-steps-architecture.html","title":"Tutorial: STEPS architecture","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest STEPS architecture Approach for functional autotests development based on next principles: Any complex test may be divided to atomic steps. Almost all tests contain steps which are (or may be) used in other tests. Each step should be finished with verification that its result is correct. Verification of step may be disabled if it needs for negative scenarios. Steps are separated to change-steps, get-steps, check-steps. change-step should return true if it was executed and doesn't return another step-specific value. change-step should return false if it wasn't executed. change-steps may be connected to opposite pair: start &amp; finish. if start change-step wasn't executed, finish change-step shouldn't be executed. × Search results Close "},"tutorial-steps-protocol.html":{"id":"tutorial-steps-protocol.html","title":"Tutorial: STEPS protocol","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest STEPS protocol Way to develop GlaceJS-compatible applications which may be used as GlaceJS plugins. Any application which implements STEPS protocol should follow next rules: Its modules should be lazy-loaded, for example, require(&quot;glace-web&quot;) should be empty by default It should provide Steps module, which based on STEPS architecture, for example, require(&quot;glace-web&quot;).Steps Steps module is object with functions, which will be mixed with base Steps class. It should provide globals module, for example, require(&quot;glace-web&quot;).globals, which will be loaded after main globals and may override it. It should provide pluginHelp module, for example, require(&quot;glace-web&quot;).pluginHelp, which will extend application help. It should active plugin fixtures on Steps module import. STEPS protocol is bidirectional. It means that any plugin may be easily transformed to standalone application, and any standalone application may be used as plugin. × Search results Close "},"tutorial-test-fixtures.html":{"id":"tutorial-test-fixtures.html","title":"Tutorial: Test fixtures","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Test fixtures If you need to provide some before and/or after hooks in tests or group of tests, in order to avoid copy-paste you may develop and reuse fixtures. var myFixture = func =&gt; { before(() =&gt; { console.log(&quot;called before&quot;); }); func(); after(() =&gt; { console.log(&quot;called after&quot;); }); }; test(&quot;My test&quot;, /* options */ null, [myFixture], () =&gt; { chunk(() =&gt; {}); }); scope(&quot;My tests&quot;, /* options */ null, [myFixture], () =&gt; { test(&quot;#1&quot;, () =&gt; { chunk(() =&gt; {}); }); test(&quot;#2&quot;, () =&gt; { chunk(() =&gt; {}); }); }); × Search results Close "},"tutorial-test-options.html":{"id":"tutorial-test-options.html","title":"Tutorial: Test & chunk options","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest Test &amp; chunk options When you develop a test you may pass options to test or chunk, which override config values for concrete test or chunk. Test optionsskip unwanted testtest(&quot;My test&quot;, { skip: true }, () =&gt; { chunk(() =&gt; { // payload }); });test(&quot;My test&quot;, { skip: true, skipReason: &quot;Opened bug http://tracker.com/bugs/121&quot; }, () =&gt; { chunk(() =&gt; { // payload }); });retry failed testtest(&quot;My test&quot;, { retry: 2 }, () =&gt; { chunk(() =&gt; { // payload }); })retry failed chunkstest(&quot;My test&quot;, { chunkRetry: 2 }, () =&gt; { chunk(() =&gt; { // payload }); });chunks execution timeouttest(&quot;My test&quot;, { chunkTimeout: 1 }, () =&gt; { chunk(() =&gt; { // payload }); });Chunk optionsretry failed chunktest(&quot;My test&quot;, () =&gt; { chunk({ retry: 2 }, () =&gt; { // payload }); });chunk execution timeouttest(&quot;My test&quot;, () =&gt; { chunk({ timeout: 1 }, () =&gt; { // payload }); }); × Search results Close "},"tutorial-tests-loading.html":{"id":"tutorial-tests-loading.html","title":"Tutorial: How glace loads tests","body":" GlaseJS Namespaces GlaceConfig Modules clierrorglobals/indexhackingindexloadermatcherpluginsreporter/indexreporter/stdoutreporter/testrailreporter/xunittesting Classes GlaceReportererror~ConfigErrorerror~StepErrortesting~TestCaseSteps Mixins TimerSteps Tutorials GlaceJS conceptsMocha broken queue with uncaught exceptionsTests parameterizationRelease NotesTest reportsTests and chunks retrySTEPS architectureSTEPS protocolTest fixturesTest &amp; chunk optionsHow glace loads tests Global afterChunkbaseTestbeforeChunkchunkCONFexpectforEachLanguagehelpreportersrewirerunscopesessionsessNumsetLogsinonSStest How glace loads tests By default glace tries to load tests from folder tests in the same folder where command glace was called. Tests are loaded from folder recursively from subfolders too. It's possible to explicitly specify path to tests folder, for example: glace /path/to/tests/dir, or to sequence of folders: glace /path/to/dir1 /path/to/dir2. In folder, test files should have prefix test, for example: testMainPage.js, tests.js, etc. Otherwise they will be missed. Also it's possible to specify path to test file or sequence of test files (prefix test isn't require in such case): glace /path/to/myTests.js /path/to/otherTests.js. Or to mix folders and files: glace /path/to/tests/dir /path/to/myTests.js. conftest.jsconftest.js is a special file which will be loaded before tests loading and usually contains some preparation stuff. Conftest may be located in any folder inside test folder hierarchy. If conftest is located on one level with tests folder it will be loaded before tests session start and global objects initialization. It's possible to specify root conftest path via CLI option --root-conftest which will be loaded before top level conftests, but after programmatically configured preloads. × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
